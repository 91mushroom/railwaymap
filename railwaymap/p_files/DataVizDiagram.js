(window.webpackJsonpdatavizCharts=window.webpackJsonpdatavizCharts||[]).push([[21],{579:function(t,e,i){(function(t){
/*!
 * Axis兼容定义
 */
!function(t){var e=i(561);function o(t){var e=t[0],i=t[t.length-1];return e<i?[e,i]:[i,e]}t.exports=function(){var t,i=e.d3.scale.linear(),n="bottom",a=6,s=6,r=6,h=3,l=[10],u=0,d={},c={},f={},m={};function p(e){var p=i.ticks?i.ticks.apply(i,l):i.domain(),g=void 0===t?i.tickFormat?i.tickFormat.apply(i,l):String:t,v=function(t,e,i){var n=[];if(i&&e.length>1){for(var a,s,r=o(t.domain()),h=-1,l=e.length,u=(e[1]-e[0])/++i;++h<l;)for(a=i;--a>0;)(s=+e[h]-a*u)>=r[0]&&n.push(s);for(--h,a=0;++a<i&&(s=+e[h]+a*u)<r[1];)n.push(s)}return n}(i,p,u),y=function(t){return t.rangeExtent?t.rangeExtent():o(t.range())}(i),x=e.set();switch(n){case"bottom":v.forEach(function(t,o,n){var a=i.ticks?i(t):i(t)+i.rangeBand()/2;x.push(e.path("M"+a+","+s+"V0").attr(f))}),p.forEach(function(t,o,n){var s=i.ticks?i(t):i(t)+i.rangeBand()/2;x.push(e.path("M"+s+","+a+"V0").attr(d)),x.push(e.text(s,Math.max(a,0)+h+2,"function"==typeof g?g(t):g).attr({"text-anchor":"middle"}).attr(c))}),x.push(e.path("M"+y[0]+","+r+"V0H"+y[1]+"V"+r).attr(m));break;case"top":v.forEach(function(t,o,n){var a=i.ticks?i(t):i(t)+i.rangeBand()/2;x.push(e.path("M"+a+","+-s+"V0").attr(f))}),p.forEach(function(t,o,n){var s=i.ticks?i(t):i(t)+i.rangeBand()/2;x.push(e.path("M"+s+","+-a+"V0").attr(d)),x.push(e.text(s,-(Math.max(a,0)+h+2),"function"==typeof g?g(t):g).attr({"text-anchor":"middle"}).attr(c))}),x.push(e.path("M"+y[0]+","+-r+"V0H"+y[1]+"V"+-r).attr(m));break;case"left":v.forEach(function(t,o,n){var a=i.ticks?i(t):i(t)+i.rangeBand()/2;x.push(e.path("M"+-s+","+a+"H0").attr(f))}),p.forEach(function(t,o,n){var s=i.ticks?i(t):i(t)+i.rangeBand()/2;x.push(e.path("M"+-a+","+s+"H0").attr(d)),x.push(e.text(-(Math.max(a,0)+h),s,"function"==typeof g?g(t):g).attr({"text-anchor":"end"}).attr(c))}),x.push(e.path("M"+-r+","+y[0]+"H0V"+y[1]+"H"+-r).attr(m));break;case"right":v.forEach(function(t,o,n){var a=i.ticks?i(t):i(t)+i.rangeBand()/2;x.push(e.path("M"+s+","+a+"H0").attr(f))}),p.forEach(function(t,o,n){var s=i.ticks?i(t):i(t)+i.rangeBand()/2;x.push(e.path("M"+a+","+s+"H0").attr(d)),x.push(e.text(Math.max(a,0)+h,s,"function"==typeof g?g(t):g).attr({"text-anchor":"start"}).attr(c))}),x.push(e.path("M"+r+","+y[0]+"H0V"+y[1]+"H"+r).attr(m))}return x}return p.scale=function(t){return arguments.length?(i=t,p):i},p.orient=function(t){return arguments.length?(n=t,p):n},p.ticks=function(){return arguments.length?(l=arguments,p):l},p.tickFormat=function(e){return arguments.length?(t=e,p):t},p.tickSize=function(t,e,i){if(!arguments.length)return a;var o=arguments.length-1;return a=+t,s=o>1?+e:a,r=o>0?+arguments[o]:a,p},p.tickPadding=function(t){return arguments.length?(h=+t,p):h},p.tickSubdivide=function(t){return arguments.length?(u=+t,p):u},p.tickAttr=function(t){return arguments.length?(d=t,p):d},count=0,p.tickTextAttr=function(t){if(!arguments.length)return c;if(0!=count){var e=[];for(var i in t)e.push(i);c[e[0]]=t[e[0]]}else c=t;return count++,p},p.minorTickAttr=function(t){return arguments.length?(f=t,p):f},p.domainAttr=function(t){return arguments.length?(m=t,p):m},p}}(t)}).call(this,i(10)(t))},598:function(t,e,o){(function(t,e,n){!function(t){var a=o(531),s=o(561),r=o(563),h=a.extend(a.Chart,{initialize:function(t,i){this.type="TreeChart",this.node=this.checkContainer(t),this.addlink={},this.treeDepth=0,this.font={},this.defaults.width=960,this.defaults.height=700,this.defaults.deep=180,this.defaults.radius=20,this.defaults.rectWidth=60,this.defaults.rectHeight=30,this.defaults.roundRatio=4;var o=12;this.widthRatio=e(this.node).width()/this.defaults.width,this.heightRatio=e(this.node).height()/this.defaults.height,this.widthRatio>1&&this.heightRatio>1&&1==i.adaption&&(o=this.widthRatio>this.heightRatio?parseInt(o*this.heightRatio):parseInt(o*this.widthRatio)),this.defaults.textStyle={fill:"gray","font-size":o,"text-anchor":"middle","font-family":"Microsoft Yahei"},this.defaults.initDepth=3,this.defaults.horizontal=!1,this.defaults.addition=!1,this.defaults.nodeStyle="circle",this.initial=!0,this.defaults.onSpecialColor=void 0,this.defaults.onClick=function(t){},this.defaults.onMouseOver=function(t){},this.defaults.onTouchStart=function(t){},this.defaults.onTouchEnd=function(t){},this.defaults.onMouseOut=function(t){},this.defaults.nodeFormat=function(t){return""},this.defaults.customNodeStyle={"font-size":"12px","font-family":"Microsoft Yahei",color:"grey","text-align":"center"},this.setOptions(i),this.dimension={},this.defaults.initDepth<=1&&(this.defaults.initDepth=2),this._init()}});h.prototype._init=function(){var t=this,e=this.defaults;this.on("mouseover",function(){var i=this.textSet,o=this.nodesData,n=this.path,a=arguments[0],s=arguments[1],r=i[s].attr("y"),h=a.attr("r");"circle"==e.nodeStyle?(o[s]._children?a.animate({r:h+2,"stroke-opacity":.75},100):a.animate({r:h+2,"fill-opacity":.75},100),(e.horizontal=!1)&&(o[s].children?i[s].animate({y:r-12},100,"backOut"):i[s].animate({y:r+12},100,"backOut")),i[s].attr({"font-size":1.5*parseInt(e.textStyle["font-size"])})):(o[s]._children?a.animate({"stroke-opacity":.75},100):a.animate({"fill-opacity":.75},100),i[s].attr({"font-weight":"bold","font-size":1.2*parseInt(e.textStyle["font-size"])}));var l=function(e,i){var o=e.parent;o&&(n[e[t.dimension.ID]-1].attr({"stroke-width":4,"stroke-opacity":i}),i>.5&&(i-=.1),l(o,i))};l(o[s],.8);var u,d,c=o[s].parent;for(u=0,d=i.length;u<d;u++)o[u].parent===c&&u!==s&&i[u].animate({"fill-opacity":.4});var f={};f[t.dimensions[1]]=o[s][t.dimensions[1]],f[t.dimensions[2]]=o[s][t.dimensions[2]],e.onMouseOver&&e.onMouseOver(f),t.floatTag&&t.floatTag.show(f)}),this.on("mouseout",function(){var i=this.textSet,o=this.nodesData,n=this.path,a=arguments[0],s=arguments[1],r=arguments[2],h=arguments[3],l=arguments[4];"circle"==e.nodeStyle?(o[s]._children?a.animate({r:h,"stroke-width":r,"stroke-opacity":.4},100):a.animate({r:h,"fill-opacity":.4},100),i[s].attr({"font-size":e.textStyle["font-size"]}),i[s].animate({y:l},100,"backOut")):(o[s]._children?a.animate({"stroke-width":r,"stroke-opacity":.4},100):a.animate({"fill-opacity":.4},100),i[s].attr({"font-weight":"normal","font-size":e.textStyle["font-size"]}));var u=function(e){var i=e.parent;i&&(n[e[t.dimension.ID]-1].attr({"stroke-width":.4,"stroke-opacity":1}),u(i))};u(o[s]);var d,c,f=o[s].parent;for(d=0,c=i.length;d<c;d++)o[d].parent===f&&d!==s&&i[d].animate({"fill-opacity":1});var m=t.createGeneralObj(o[s],t.dimensions);m.depth=o[s].depth,m.children=o[s].children,m.parent=o[s].parent,e.onMouseOut&&e.onMouseOut(m),t.floatTag&&t.floatTag.hide()}),this.on("touchstart",function(){}),this.on("touchend",function(){})},h.prototype.hierarchyTableToJson=function(t){t[0][0]===this.dimension.ID&&(t=t.slice(1));var e="",o={},n={},a=this,s=[];if(t.forEach(function(t){if(t[0]&&""!=t[0]){if(-1!=s.indexOf(t[0]))throw new Error("DataViz Error # Source Error : 2 or more lines have same ID: "+d[0]+"(line:"+(i+1)+").");s.push(t[0])}}),t.forEach(function(t,i){if(""===t[0])throw new Error("DataViz Error # Source Error : ID can not be empty(line:"+(i+1)+").");if(-1==s.indexOf(t[3])){if(""!=e)throw new Error("DataViz Error # Source Error : 2 or more lines have an empty parentID(line:"+(i+1)+").");e=t[0],t[3]=null}}),t.forEach(function(t,e){var i,n,s="";if(t.length>4)for(i=4,n=t.length;i<n;i++)i<n-1?s=s+t[i]+",":s+=t[i];o[t[0]]={},o[t[0]][a.dimension.name]=t[1],o[t[0]][a.dimension.size]=t[2],o[t[0]][a.dimension.parentID]=t[3],o[t[0]].child=[],o[t[0]][a.dimension.ID]=t[0],o[t[0]][a.dimension.value]=t[4],o[t[0]][a.dimension.info]=t[5],o[t[0]].sum=0}),!e)throw new Error("DataViz Error # Source Error : No root node defined.");t.forEach(function(t,e){if(t[3]){var i,a,s,r=t[3].split(",");if(1===r.length)(i=o[t[3]]).child.push(t[0]);else for((i=o[r[0]]).child.push(t[0]),n[t[0]]={child:[],path:[],pnode:[]},a=1,s=r.length;a<s;a++)n[t[0]].child.push(r[a]);if(!i)throw new Error("DataViz Error # Source Error : Can not find parent with ID "+t[3]+"(line:"+(e+1)+").")}}),this.addlink=n;var r=function(t){var e=o[t];if(0===e.child.length){if(isNaN(parseFloat(e[a.dimension.size])))throw new Error("DataViz Error # Source Error : Leaf node's size is not a number(ID:"+(t+1)+").");return e.sum=parseFloat(e.size),(n=a.createGeneralObj(e,a.dimensions)).children=null,n.draw=!1,n}var i=[];e.child.forEach(function(t){i.push(r(t)),e.sum+=parseFloat(o[t].sum)});var n=a.createGeneralObj(e,a.dimensions);return a.defaults.Added&&(n[a.dimension.size]=e.sum),n.children=i,n.draw=!1,n};return r(e)},h.prototype.setSource=function(t){n.keys(t.source[0]);n.each(t.source,function(t){for(var e in t){var i=t[e];n.isNumber(i)&&(t[e]=i.toString())}});var e=this.defaults;this.dimensions=t.dimensions,this.dimensionType=t.dimensionType,this.dimensionDomain=t.dimensionDomain,this.dimension.ID=t.dimensions[0],this.dimension.originID="originID",this.dimension.name=t.dimensions[1],this.dimension.size=t.dimensions[2],this.dimension.parentID=t.dimensions[3],this.dimension.value=t.dimensions[4],this.dimension.info=t.dimensions[5];var i=[];n.each(t.source,function(e){var o=[];o.push(e[t.dimensions[0]]),o.push(e[t.dimensions[1]]),o.push(e[t.dimensions[2]]),o.push(e[t.dimensions[3]]),i.push(o)}),this.rawData=this.hierarchyTableToJson(i),this.source=this.remapSource(i),this.source.x0=e.width/2,this.source.y0=10*e.radius,this.source.children.forEach(function t(e){e.children&&(e._children=null,e.children.forEach(t))})},h.prototype.remapSource=function(t){return this.hierarchyTableToJson(t)},h.prototype.layout=function(){var t=this.defaults,e=this;1==t.horizontal?this.nodesData=s.d3.layout.tree().size([t.height,t.width]).nodes(this.source):this.nodesData=s.d3.layout.tree().size([t.width,t.height]).nodes(this.source);var i=[];if(1==this.initial){for(var o=0;o<this.nodesData.length;o++)this.nodesData[o].depth<=t.initDepth-1&&i.push(this.nodesData[o]);this.nodesData=i}var n,a=0,r=0;this.nodesData.forEach(function(t){t.depth>a&&(a=t.depth)}),this.treeDepth=a,n="circle"==t.nodeStyle?6*t.radius:t.rectWidth,1==t.horizontal?this.nodesData.forEach(function(i){var o=i.x;i.x=i.y,i.y=o,t.deep=(t.width-n)/(a+1),i.x=n+i.depth*t.deep,i[e.dimension.originID]||(i[e.dimension.originID]=i[e.dimension.ID]),i[e.dimension.ID]=r,r++}):this.nodesData.forEach(function(i){t.deep=t.height/(a+1),i.y=.5*n+i.depth*t.deep,i[e.dimension.originID]||(i[e.dimension.originID]=i[e.dimension.ID]),i[e.dimension.ID]=r,r++})},h.prototype._getColor=function(t){var e=this.defaults,i=r.getSpecialColor(e.onSpecialColor,t);if(i)return i;var o,n=r.getThemeColor(this.owner.theme);return o=n.length>1&&n[0].length>1?[n[0][0],n[1][0]]:n[0],r.gradientColor(o,"special")(t.depth/this.treeDepth)},h.prototype._createCanvas=function(){this.node.style.position="relative",this.DOMNode=e(this.canvas);var t=this;this.DOMNode.click(function(e){t.trigger("click",e)}),this.DOMNode.dblclick(function(e){t.trigger("dblclick",e)});var i=document.all?"mousewheel":"DOMMouseScroll";this.DOMNode.bind(i,function(e){t.trigger("mousewheel",e)}),this.DOMNode.bind("contextmenu",function(e){t.trigger("contextmenu",e)}),this.DOMNode.delegate("circle","click",function(e){t.trigger("circle_click",e)}),this.DOMNode.delegate("circle","mouseover",function(e){t.trigger("circle_mouseover",e)}),this.DOMNode.delegate("circle","mouseout",function(e){t.trigger("circle_mouseout",e)})},h.prototype.zoom=function(t){var e=t||2,i=this.defaults;i.width=i.width*e,i.height<=this.treeDepth*i.deep&&(i.height=i.height*e),this.canvas.setSize(i.width,i.height),this.canvas.setViewBox(0,0,i.width,800),this.defaults=i,this.render()},h.prototype.getLinkPath=function(t,e,i,o){var n,a=this.defaults;if(1==a.horizontal){var s=t+(i-t)/2,r=e,h=i-(i-t)/2,l=o;n=[["M",t+a.radius,e],["C",s,r,h,l,i-a.radius,o]]}else{s=t,r=e+(o-e)/2,h=i,l=o-(o-e)/2;n=[["M",t,e+a.radius],["C",s,r,h,l,i,o-a.radius]]}return n},h.prototype.generatePaths=function(){var t=this.canvas,i=this,o=this.defaults,s=o.radius,r=o.rectWidth,h=o.rectHeight,l=0,u=n.clone(o.textStyle);u["font-size"]=u["font-size"]?parseInt(u["font-size"]):12,u["font-size"]=u["font-size"];var d,c,f=this.nodesData,m=this.addlink,p=t.set(),g=t.set(),v=t.set(),y=[],x=this;for(e(this.node).append(this.floatTag),d=0,c=f.length;d<c;d++){var w,b,k,S,C,M,D,T,I=f[d],z=I.parent,O=t.set();if(m[I[i.dimension.ID]])for(w=0,k=m[I[i.dimension.ID]].child.length;w<k;w++)for(b=0;b<c;b++)f[b][i.dimension.ID]===m[I[i.dimension.ID]].child[w]&&(m[I[i.dimension.ID]].pnode[w]=b,m[I[i.dimension.ID]].path[w]=t.path().attr({stroke:o.lineFill,"stroke-width":.5}));"circle"==o.nodeStyle?(z&&I.draw?(S=z.x,M=z.y):(S=I.x,M=I.y),C=I.x,D=I.y):(z&&I.draw?(S=z.x-.5*r,M=z.y-.5*h):(S=I.x-.5*r,M=I.y-.5*h),C=I.x-.5*r,D=I.y-.5*h),z&&y.push(t.path().attr({stroke:o.lineFill,"stroke-width":.5})),T="circle"==o.nodeStyle?t.circle(S,M,s).animate({cx:C,cy:D},500,"backOut"):t.rect(S,M,r,h,o.roundRatio).animate({x:C,y:D},500,"backOut");var B,j,N;i.createGeneralObj(f[d],i.dimensions);T.attr({fill:i._getColor(I),stroke:"#ffffff","stroke-width":1,"fill-opacity":.4,data:12}).data("num",d).data("name",f[d][i.dimension.name]).data("ID",f[d][i.dimension.ID]).data("originID",f[d][i.dimension.originID]).click(function(t){i.fire("click",f[this.data("num")]),i.floatTag&&i.floatTag.hide(),x.update(this.data("originID"));var e=i.createGeneralObj(f[this.data("num")],i.dimensions);i.defaults.onClick(t,e)}).mouseup(function(t){if(a.isMobile)return null;var e=i.createGeneralObj(f[this.data("num")],i.dimensions);i.defaults.onMouseUp(t,e)}).touchstart(function(t){l=new Date;var e=i.createGeneralObj(f[this.data("num")],i.dimensions);i.defaults.onTouchStart(t,e)}).touchend(function(t){var e=i.createGeneralObj(f[this.data("num")],i.dimensions);if(new Date-l<400)i.fire("click",f[this.data("num")]),i.floatTag&&i.floatTag.hide(),x.update(this.data("originID")),i.defaults.onClick(t,e);else if(new Date-l>500)return;i.defaults.onTouchEnd(t,e)}),g.push(T),O.push(T),(I.children||I._children)&&1==this.initial&&I.depth==o.initDepth-1&&(I._children=I.children,I.children=null),B="circle"==o.nodeStyle?s:.3*o.rectHeight,I._children&&(g[d].attr({stroke:i._getColor(I),"stroke-width":B,"stroke-opacity":.4,"fill-opacity":1}),"circle"==o.nodeStyle&&g[d].attr({r:s/2})),"circle"==o.nodeStyle?I.children?1==o.horizontal?(j=I.x-s-2,N=I.y):(j=I.x,N=I.y-s-7):1==o.horizontal?(j=I.x+s+2,N=I.y):(j=I.x,N=I.y+s+7):(j=I.x,N=I.y);var _=t.text(j,N,I[i.dimension.name]).attr(u).data("num",d).data("name",f[d][i.dimension.name]);I.children&&1==o.horizontal&&"circle"==o.nodeStyle&&_.attr("text-anchor","end"),I.children||1!=o.horizontal||"circle"!=o.nodeStyle||_.attr("text-anchor","start"),v.push(_),O.push(_),p.push(O)}p.forEach(function(t,n){e(t[0].node).attr("value",f[n].value),t[0].data({textY:v[n].attr("y"),thisstrokewidth:t[0].attr("stroke-width"),thisradius:t[0].attr("r")});var a,s=t[0].data("textY"),r=t[0].data("thisradius");a="circle"==o.nodeStyle?t[0].data("thisstrokewidth"):.3*o.rectHeight,t.mouseover(function(){i.fire("mouseover",t[0],n)}).mouseout(function(){i.fire("mouseout",t[0],n,a,r,s)})}),g.onAnimation(function(){var t,e,n=0;for(t=1,e=g.length;t<e;t++){var a,s,r,h,l,u,d,c,p=g[t],v=f[t],w=v.parent;if("circle"==o.nodeStyle?(a=w.x,s=w.y,r=p.attr("cx"),h=p.attr("cy")):(1==o.horizontal?(a=w.x+.35*o.rectWidth,r=p.attr("x")+.15*o.rectWidth):(a=w.x,r=p.attr("x")+.5*o.rectWidth),s=w.y,h=p.attr("y")+.5*o.rectHeight),y[n].attr({path:x.getLinkPath(a,s,r,h)}),n++,m[v[i.dimension.ID]])for(l=0,d=m[v[i.dimension.ID]].child.length;l<d;l++)for(u=0,c=f.length;u<c;u++){var b=f[u];if(b[i.dimension.ID]===m[v[i.dimension.ID]].child[l]){var k=x.getLinkPath(b.x,b.y,p.attr("cx"),p.attr("cy"));m[v[i.dimension.ID]].path[l].attr({path:k})}}}}),this.nodes=g,this.path=y,this.textSet=v},h.prototype.generateRichNode=function(){var t=this.canvas,i=this,o=this.defaults,a=o.rectWidth,s=(o.rectHeight,[]),r=[];this.nodes;var h,l,u=this,d=n.clone(o.textStyle);d["font-size"]=d["font-size"]?parseInt(d["font-size"]):12,d["font-size"]=d["font-size"];var c,f,m=this.nodesData;for(c=0,f=m.length;c<f;c++){var p,g,v=m[c],y=v.parent;y&&r.push(t.path().attr({stroke:"#939598","stroke-width":.5})),g=(p=i.creatNode(o.nodeFormat(v)).attr({id:c})).width()>60?p.width():60,p.css({width:g}),p.css(o.customNodeStyle),p.height(),y&&v.draw?(h=y.x-.5*a,l=y.y):(h=v.x-.5*a,l=v.y);var x=v.x-.5*a,w=v.y;p.css({left:h,top:l}),p.animate({left:x,top:w},"fast"),s.push(p);var b=i.createGeneralObj(m[c],i.dimensions);b.depth=m[c].depth,b.children=m[c].children,b.parent=m[c].parent,(v.children||v._children)&&1==this.initial&&v.depth==o.initDepth-1&&(v._children=v.children,v.children=null);var k=p.width();v._children?(p.css({cursor:"pointer"}),p.append('<img src="images/icon-open.png" alt="自定义图片" style="margin-left:'+(k-16)+'px" />')):v._children||0==v.depth||null==v.children||(p.css({cursor:"pointer"}),p.append('<img src="images/icon-close.png" alt="自定义图片" style="margin-left:'+(k-15)+'px" />')),p.click(function(t){i.floatTag&&i.floatTag.hide(),u.update(m[this.id].name),i.defaults.onClick(b)}),e(p).hover(function(t){var e=i.createGeneralObj(m[this.id],i.dimensions);e.depth=m[this.id].depth,e.children=m[this.id].children,e.parent=m[this.id].parent,o.onMouseOver(t,e),i.floatTag&&i.floatTag.show(e);var n=function(t,e){var o=t.parent;o&&(r[t[i.dimension.ID]-1].attr({"stroke-width":4,"stroke-opacity":e}),e>.5&&(e-=.1),n(o,e))};n(m[this.id],.8)},function(t){o.onMouseOut(t,b),i.floatTag&&i.floatTag.hide();var e=function(t){var o=t.parent;o&&(r[t[i.dimension.ID]-1].attr({"stroke-width":.4,"stroke-opacity":1}),e(o))};e(m[this.id])})}this.nodes=s,function(){var t,e,i=0;for(t=1,e=s.length;t<e;t++){var n,a,h,l,d=m[t],c=m[t].parent;1==o.horizontal?(n=c.x,h=d.x+.2*s[t].width(),a=c.y+.3*s[t].height(),l=d.y+.25*s[t].height()):(n=c.x-.15*s[t].width(),h=d.x-.2*s[t].width(),a=c.y+.6*s[t].height(),l=d.y-.1*s[t].height()),r[i].attr({path:u.getLinkPath(n,a,h,l)}),i++}}(),this.path=r;this.defaults.top},h.prototype.update=function(t){for(var e=void 0,i=this.source,o=this.defaults,n=this,a=0;a<this.nodes.length;a++){if("custom"==this.defaults.nodeStyle){if((this.nodes[a][0].textContent||this.nodes[a][0].innerText)==name){e=parseInt(this.nodes[a][0].id);break}}else if(this.nodes[a].data("originID")==t){e=this.nodes[a].data("num");break}}i.children.forEach(function t(e){e.draw=!1,e.children&&e.children.forEach(t)}),i.children.forEach(function t(i){i[n.dimension.ID]===e?i.children?(i._children=i.children,i.children=null):(i.children=i._children,i.children&&i.children.forEach(function(t){t.draw=!0,t.children&&(t._children=t.children,t.children=null)}),i._children=null):i.children&&i.children.forEach(t)}),this.source=i,this.source.x0=o.width/2,this.source.y0=2*o.radius,this.render()},h.prototype.render=function(t){if(this.canvas.clear(),this.setOptions(t),this.layout(),"custom"==this.defaults.nodeStyle){if(document.getElementById("nodeContainer"))e("#nodeContainer > div").remove();else{container=e(this.node);var i=e("<div/>").attr({id:"nodeContainer"});container.append(i)}this.generateRichNode()}else this.generatePaths();this.initial=!1},h.prototype.creatNode=function(t){container=e("#nodeContainer");var i=e("<div/>").css({padding:"12px 8px",position:"absolute"});return container.append(this.floatTag),container.append(i),i.html(t),i},h.prototype._getNode=function(t){return this.defaults.nodeFormat.call(this,t)},h.prototype.mousedblclick=function(t,e,i){this.defaults.onDblClick&&this.defaults.onDblClick(t,e,i)},t.exports=h}(t)}).call(this,o(10)(t),o(18),o(16))},599:function(t,e,i){(function(t,e){
/*!***********************************************
Copyright (c) 2014, Neusoft Inc.
All rights reserved.
SaCa DataViz Version 2.0.0
************************************************/
!function(t){var o=i(531),n=i(563),a=o.extend(o.Chart,{initialize:function(t,e){this.type="TagcloudChart",this.node=this.checkContainer(t),this.defaults.width=400,this.defaults.height=400,this.defaults.shape="circle",this.defaults.rotateAngle=0,this.defaults.textStyle={"font-family":"Microsoft YaHei","font-weight":"bold"},this.defaults.onSpecialColor=void 0,this.defaults.onClick=function(t){},this.defaults.onTouchStart=function(t){},this.defaults.onTouchEnd=function(t){},this.defaults.onMouseOver=function(t){},this.defaults.onMouseOut=function(t){},this.setOptions(e),this.dimension={},this.weightDomain=0,this.rad,this.source,this.center={x:this.defaults.width/2,y:this.defaults.height/2},this._setRad(),this.canvas,this.textSet=[],this.isChoosed=!1}});a.prototype._setColor=function(){var t=this.owner.theme;this.owner.colorArray=0==this.owner.colorArray.length?n.getThemeColor(t):this.owner.colorArray},a.prototype._layout=function(){var t=null,e=0;this._setColor();for(var i=this.source,n=this.canvas,a=this.floatTag,s=this,r=this.defaults.width,h=this.defaults.height,l={},u=0,d=0,c=[],f=i.length>=.3*Math.min(r,h)?.3*Math.min(r,h):i.length,m=function(){for(;s._hitTest(l,c)||s._overBorder(l);){if(u++>30)return;8,(d+=8)>1e9&&(d=0),s._adjustPosition(s.defaults.shape),l.attr("x",left_adjust),l.attr("y",top_adjust),l.center={x:(l.getBBox().x+l.getBBox().x2)/2,y:(l.getBBox().y+l.getBBox().y2)/2},s._getCoordinate(l)}},p=0;p<f;p++){var g=i[p];(l=n.text(r/2,h/2,i[p][s.dimension.text]).data("obj",g).attr(s.defaults.textStyle).attr({"font-size":this._getWeight(p),fill:this._getColor(g)})).text=i[p][s.dimension.text],l.weight=i[p][s.dimension.weight],l.hover(function(t){a&&a.show(this.data("obj")),this.attr({cursor:"pointer"}),s.isChoosed||this.attr({opacity:.5}),s.defaults.onMouseOver(t,this.data("obj"))},function(t){a&&a.hide(),this.attr({cursor:"auto"}),s.isChoosed||this.attr({opacity:1}),s.defaults.onMouseOut(t,this.data("obj"))}).click(function(t){if(o.isMobile)return null;var e=this.data("obj");s.defaults.onClick(t,e)}).mouseup(function(t){if(o.isMobile)return null;var e=this.data("obj");s.defaults.onMouseUp(t,e)}).touchstart(function(i){e=new Date,t&&clearTimeout(t);var o=this,n=this.data("obj");a&&a.hide(),o.attr({cursor:"pointer"}),s.isChoosed||o.attr({opacity:.5}),s.defaults.onMouseOver(i,n),t=setTimeout(function(){o.attr({cursor:"auto"}),s.isChoosed||o.attr({opacity:1}),s.defaults.onMouseOut(i,n),t&&clearTimeout(t)},3e3),s.defaults.onTouchStart(i,n)}).touchend(function(t){var i=this.data("obj");if(new Date-e<400)s.defaults.onClick(i);else if(new Date-e>500)return;s.defaults.onTouchEnd(t,i)}),l.height=l.getBBox().height-5,l.width=l.getBBox().width-5,l.center={x:(l.getBBox().x+l.getBBox().x2)/2,y:(l.getBBox().y+l.getBBox().y2)/2},this.textSet.push(l),0==p&&(l.center.y=l.center.y+5),this._axisRotate(l),this._getCoordinate(l),m(),u<30?c.push(l):l.hide(),0,u=0}},a.prototype._axisRotate=function(t){var e=Math.random()-.5;e/=Math.abs(e),0===this.defaults.rotateAngle?t.angle=0:void 0===this.defaults.rotateAngle?t.angle=e*(t.id%3==0?0:t.id%3==1?30:45)*Math.PI/180:t.angle=e*(t.id%2==0?0:this.defaults.rotateAngle)*Math.PI/180,t.transform("r"+180*t.angle/Math.PI)},a.prototype._getCoordinate=function(t){t.p=[],t.diagonal=Math.sqrt(Math.pow(t.width,2)+Math.pow(t.height,2))/2;var e=Math.asin(t.height/2/t.diagonal);t.angle_p0_rotate=e+t.angle,t.angle_p1_rotate=e-t.angle;var i=t.diagonal*Math.cos(t.angle_p0_rotate),o=t.diagonal*Math.sin(t.angle_p0_rotate),n=t.diagonal*Math.cos(t.angle_p1_rotate),a=t.diagonal*Math.sin(t.angle_p1_rotate);t.p[0]={x:t.center.x-i,y:t.center.y-o},t.p[1]={x:t.center.x+n,y:t.center.y-a},t.p[2]={x:t.center.x+i,y:t.center.y+o},t.p[3]={x:t.center.x-n,y:t.center.y+a}},a.prototype._hitTest=function(t,e){for(var i=0,o=function(t,e){return t.x*e.y-t.y*e.x},n=function(t,e,i,n){var a={x:t.x-i.x,y:t.y-i.y},s={x:e.x-i.x,y:e.y-i.y},r={x:n.x-i.x,y:n.y-i.y},h=o(a,r)*o(s,r);a={x:i.x-t.x,y:i.y-t.y},s={x:n.x-t.x,y:n.y-t.y},r={x:e.x-t.x,y:e.y-t.y};return h<=0&&o(a,r)*o(s,r)<=0},a=0;a<e.length;a++){if(Math.sqrt(Math.pow(t.center.x-e[a].center.x,2)+Math.pow(t.center.y-e[a].center.y,2))<t.diagonal+e[a].diagonal){i=0;for(var s=0;s<4;s++){for(var r=0;r<4;r++){if(n(t.p[s%4],t.p[(s+1)%4],e[a].p[r%4],e[a].p[(r+1)%4]))return!0;n({x:0,y:0},t.center,e[a].p[r%4],e[a].p[(r+1)%4])&&(i+=1)}if(i%2==1)return!0}}}return!1},a.prototype._overBorder=function(t){for(var e=0;e<4;e++)if(t.p[e].x<0||t.p[e].x>this.defaults.width||t.p[e].y<0||t.p[e].y>this.defaults.height)return!0;return!1},a.prototype._adjustPosition=function(t){if("circle"===t){var e=Math.random()*this.rad,i=2*Math.random()*Math.PI;left_adjust=e*Math.cos(i)+this.defaults.width/2,top_adjust=e*Math.sin(i)+this.defaults.height/2}else"rectangle"===t&&(left_adjust=Math.random()*this.defaults.width,top_adjust=Math.random()*this.defaults.height)},a.prototype.setSource=function(t){this.defaults;this.source=t.source,this.dimensions=t.dimensions,this.dimensionType=t.dimensionType,this.dimensionDomain=t.dimensionDomain,this.dimension.text=t.dimensions[0],this.dimension.weight=t.dimensions[1],this.dimension.info=t.dimensions[2];var e=this.dimension.weight;this.weightDomain=this.dimensionDomain[e][1]-this.dimensionDomain[e][0],this.source.sort(function(t,i){return t[e]<i[e]?1:t[e]>i[e]?-1:0})},a.prototype.render=function(){this._layout()},a.prototype._getColor=function(t){var e=this.defaults;return n.getSpecialColor(e.onSpecialColor,t)||n.getColor(t[this.dimension.text],this.owner.colorDict,this.owner.colorArray)},a.prototype._getWeight=function(t){return this.source[t][this.dimension.weight]/this.weightDomain*(this.rad/5)+this.defaults.textStyle["font-size"]},a.prototype._getOpacity=function(t){return this.source[t][this.dimension.weight]/this.weightDomain*1+.5},a.prototype._setRad=function(){this.rad=Math.min(this.defaults.width,this.defaults.height)/2},a.prototype._setIsChoosed=function(t){this.isChoosed=t},a.prototype.chooseText=function(t){e.each(this.textSet,function(t){t.attr({opacity:1})});var i=this,o=[];if(!e.isArray(t))throw new Error("DataViz Error # Type Error : The parameter should be 'Array' type!");return o=t,function(t,o){return e.each(t,function(t){e.contains(o,t.text)?fasText=!0:t.attr({opacity:.1})}),i._setIsChoosed(fasText),fasText}(i.textSet,o)},a.prototype.chooseWeight=function(t){e.each(this.textSet,function(t){t.attr({opacity:1})});var i,o=this,n=[];if(!e.isArray(t))throw new Error("DataViz Error # Type Error : The parameter should be 'Array' type!");switch(t.length){case 0:throw new Error("DataViz Error # Length Error : The parameter's length is 0!");case 1:i=function(t,i){return!e.contains(t,i)};break;case 2:default:n=e.sortBy(t.slice(0,2),function(t){return Math.max(t)}),i=function(t,e){return!(e>=t[0]&&e<=t[1])}}return function(t,i,n){return e.each(t,function(t){n(i,t.weight)?t.attr({opacity:.1}):fasText=!0}),o._setIsChoosed(fasText),fasText}(o.textSet,n,i)},a.prototype.restore=function(){e.each(this.textSet,function(t){t.attr({opacity:1})}),this._setIsChoosed(!1)},a.prototype.mousedblclick=function(t,e,i){this.defaults.onDblClick&&this.defaults.onDblClick(t,e,i)},t.exports=a}(t)}).call(this,i(10)(t),i(16))},600:function(t,e,i){(function(t,e){
/*!
 * StreamLegend的兼容定义
 */
!function(t){var o=i(531),n=o.extend(o.Chart,{initialize:function(t){this.limit=20,this.from=0,this.to=0,this.dimension.type={type:"string",required:!0,index:1},this.dimension.value={type:"number",required:!0,index:2},this.defaults.percentageBarColor="#f4f4f4",this.defaults.percentageBarTextColor="#333",this.setOptions(t)}});n.prototype.init=function(){this.paper=this.owner.canvas},n.prototype.setSource=function(t,i){i=this.map(i),this.grouped=e.groupBy(t,i.type),this.types=e.keys(this.grouped),this.types.length>this.limit&&(this.to=this.limit)},n.prototype.render=function(){this.init();var t=this.defaults;this.rect||(o.vml,this.rect=this.paper.rect(0,0,t.percentageWidth,t.height-t.axisHeight).attr({fill:t.percentageBarColor,stroke:"#aaa","stroke-width":.5}),this.text=this.paper.text(t.percentageWidth/2,10,Math.round(100)+"%").attr({"text-anchor":"middle",fill:t.percentageBarTextColor}))},t.exports=n}(t)}).call(this,i(10)(t),i(16))},601:function(t,e,i){(function(t,e){
/*!
 * Stream的兼容定义
 */
!function(t){var o=i(531);o.Axis=i(579);var n=i(561),a=o.extend(o.Chart,{initialize:function(t){this.dimension.x={type:"string",required:!0,index:0},this.defaults.axisTextColor="#333",this.defaults.axisfontSize="12px",this.defaults.axisPopSize=23,this.defaults.axisPopColor="#000",this.defaults.axisPopTextColor="#fff",this.setOptions(t)}});a.prototype.setSource=function(t,i){i=this.map(i),this.grouped=e.groupBy(t,i.x),this.axis=e.keys(this.grouped),this.range=[0,this.axis.length-1]},a.prototype.init=function(){this.paper=this.owner.canvas},a.prototype.render=function(){this.init();var t=this.defaults,e=this,i=t.percentageWidth,a=t.width-t.percentageWidth,s=this.paper.text(0,t.height-t.axisHeight,this.axis[0]),r=Math.floor((a-i)/s.getBBox().width/2)+1;s.remove(),this.dateScale=n.d3.scale.linear().domain([0,this.axis.length-1]).range([i,a]),o.Axis().scale(this.dateScale).ticks(r).tickTextAttr({fill:t.axisTextColor}).tickTextAttr({"font-size":t.axisfontSize}).tickSize(t.height-t.axisHeight+6,3,3).tickAttr({stroke:"none"}).minorTickAttr({stroke:"none"}).domainAttr({stroke:"none"}).tickFormat(function(t){return e.axis[t]||""})(this.paper),this.axisPopBubble=this.paper.path(function(e){var i=4,o=t.axisPopSize,n={height:8};return e&&((n=e.getBBox()).height*=.6,o=n.width/2-i),["M",0,0,"l",i,i,o,0,"a",i,i,0,0,1,i,i,"l",0,n.height,"a",i,i,0,0,1,-i,i,"l",-(2*i+2*o),0,"a",i,i,0,0,1,-i,-i,"l",0,-n.height,"a",i,i,0,0,1,i,-i,"l",o,0,"z"].join(",")}(this.axisPopText)).attr({fill:t.axisPopColor,stroke:t.axisPopColor,transform:"t"+i+","+(t.height-t.axisHeight)}).hide(),this.axisPopText=this.paper.text(0,t.height-t.axisHeight+11,this.axis[0]).attr({"text-anchor":"middle",fill:t.axisPopTextColor,"font-size":t.axisfontSize,transform:"t"+i+",0"}).toFront().hide()},a.prototype.hideTab=function(){this.axisPopText.hide(),this.axisPopBubble.hide()},a.prototype.showTab=function(){this.axisPopText.show(),this.axisPopBubble.show()},a.prototype.refreshTab=function(t){var e=this.defaults,i=(e.width-e.percentageWidth-35)*t/(this.axis.length-1)+e.percentageWidth;this.axisPopText.attr({text:this.axis[t+this.range[0]]}),this.axisPopText.transform("t"+i+",0"),this.axisPopBubble.transform("t"+i+","+(e.height-e.axisHeight))},t.exports=a}(t)}).call(this,i(10)(t),i(16))},602:function(t,e,i){(function(t,e){
/*!
 * PathLabel的兼容定义
 */
!function(t){var o=i(531),n=i(561),a=o.extend(o.Chart,{initialize:function(){this.dimension.type={type:"string",required:!0,index:1},this.dimension.x={type:"string",required:!0,index:0},this.dimension.value={type:"number",required:!0,index:2}}});a.prototype.render=function(){this.clear();var t,i=this,a=this.owner,s=a.paths,r=this.defaults,h=a.pathSource,l=[],u=function(t,e){var i,o,n,a,s,r=0,h=0,l=0,u=0,d=e.getBBox(),c=!0;for(0===(o=Math.ceil(d.width/(t[1].x-t[0].x)/2))&&(o=1),t.forEach(function(t,e,i){var s=Math.max(.15*i.length,o);e>=s&&e<=i.length-s&&t.y>u&&(n=t.y0-t.y,a=t.y0,u=t.y,l=e)}),i=l-o;i<=l+o;i++){if(i<0||i>=t.length){0,c=!1;break}(s=t[i]).y0-s.y>n&&(n=s.y0-s.y),s.y0<a&&(a=s.y0)}return c&&a-n>=.8*d.height?(r=t[l].x,h=(n+a)/2):c=!1,{x:r,y:h,showLabel:c}},d=this.defaults.getPathLabel||this.getPathLabel,c=e.values(this.sorted);t=r.more?o.more(c,r.level,r.max,function(t){var e={};return e.type=r.moreLabel,e.rank=t[0].rank,e.sum=n.sum(t,"sum"),e}):c.slice(0);for(var f=0,m=s.length;f<m;f++){var p=s[f],g=t[f],v={type:g.type,rank:g.rank,sum:g.sum,total:this.total},y=d.call(this,v),x=(i=this,a.paper.text(100,10,y).attr({textAnchor:"middle",fill:"white","font-size":i.defaults.fontSize,fontFamily:"Microsoft Yahei"}));x.labelLoc=u(h[f],x),x.labelLoc.showLabel?x.attr({x:x.labelLoc.x,y:x.labelLoc.y}):x.attr({opacity:0}),p.attr({cursor:"auto"}),x.attr({cursor:"auto"}),l.push(x)}this.labels=l},a.prototype.getPathLabel=function(t){return t.type+" 排名: 第"+t.rank},a.prototype.hidden=function(){this.labels.forEach(function(t){t.hide()})},a.prototype.show=function(){this.labels.forEach(function(t){t.labelLoc.showLabel&&t.show()})},a.prototype.clear=function(){this.labels&&this.labels.forEach(function(t){t.remove()})},a.prototype.setSource=function(t,i){var o=this;this.map(i),this.groupedByType=e.groupBy(t,this.mapping.type);var a=e.sortBy(this.groupedByType,function(t,e){var i=n.sum(t,o.mapping.value);return o.groupedByType[e].sum=i,o.groupedByType[e].type=e,-i});this.sorted=a,this.types=e.keys(this.groupedByType),e.each(a,function(t,e){o.groupedByType[t[0][o.mapping.type]].rank=e+1}),this.total=n.sum(e.map(o.groupedByType,function(t){return t.sum}))},t.exports=a}(t)}).call(this,i(10)(t),i(16))},603:function(t,e,i){(function(t){
/*!
 * StreamLegend的兼容定义
 */
!function(t){var e=i(531),o=e.extend(e.Chart,{initialize:function(){}});o.prototype.render=function(){var t=this.owner.paper,e=this.defaults,i=this,o="M0 0V"+(e.height-e.axisHeight);this.indicatorLine=t.path(o).attr({stroke:"none","stroke-width":1,"stroke-dasharray":"- "}),this.highlightLine=t.path("M0 0V"+(e.height-e.axisHeight)).attr({stroke:"none","stroke-width":2}).mouseover(function(t){i.owner.highlight(this.data("rowIndex")),i.owner.legendSource&&i.owner.fire("hoverIn",i.owner.owner.legendSource[this.data("rowIndex")]),i.owner.floatTag&&i.owner.floatTag.show(i.owner.getTipContent(this.data("rowIndex"),this.data("columnIndex")))}).mouseout(function(){i.owner.lowlight(this.data("rowIndex")),i.owner.legendSource&&i.owner.fire("hoverOut",i.owner.owner.legendSource[this.data("rowIndex")]);this.data("columnIndex");i.owner.floatTag&&i.owner.floatTag.hide()})},o.prototype.hidden=function(){this.indicatorLine.attr({stroke:"none"}),this.highlightLine.attr({stroke:"none"})},o.prototype.show=function(){this.indicatorLine.attr({stroke:"#000"}),this.highlightLine.attr({stroke:"white"})},o.prototype.refresh=function(t,e){var i=this.owner,o=i.pathSource,n=this.defaults,a=(n.width-n.percentageWidth-35)*t/(i.columnCount-1)+n.percentageWidth,s=o[o.length-1][t];this.indicatorLine.attr({path:"M"+a+" "+(s.y0-s.y)+"V"+o[0][t].y0}),void 0!==e&&(s=o[e][t],this.highlightLine.attr({path:"M"+a+" "+(s.y0-s.y)+"V"+s.y0}),this.highlightLine.data("rowIndex")!=e&&(this.highlightLine.data("rowIndex",e),this.highlightLine.data("columnIndex",t)))},o.prototype.clear=function(){this.indicatorLine&&this.indicatorLine.remove(),this.highlightLine&&this.highlightLine.remove()},t.exports=o}(t)}).call(this,i(10)(t))},604:function(t,e,i){(function(t,e,o){!function(t){var n=i(531),a=i(561),s=i(563),r=i(603),h=i(602),l=i(601),u=(i(600),n.extend(n.Chart,{initialize:function(t,i){this.type="StreamChart",this.node=this.checkContainer(t),this.dimension.sort={type:"string",required:!1,index:4},this.defaults.width=500,this.defaults.height=300,this.defaults.gradientColor=void 0,this.defaults.autoHeight=!1,this.defaults.heightWidthRatio=.6,this.defaults.leftLegendWidth=10,this.defaults.more=!1,this.defaults.moreLabel="more",this.defaults.max=20,this.defaults.showAxis=!1,this.defaults.axisTextColor="#333",this.defaults.axisPopColor="#000",this.defaults.axisPopTextColor="#fff",this.defaults.percentageBarColor="#f4f4f4",this.defaults.percentageBarTextColor="#333";var o=10;this.widthRatio=e(this.node).width()/this.defaults.width,this.heightRatio=e(this.node).height()/this.defaults.height,1==i.adaption&&(o=this.widthRatio>this.heightRatio?1.5*parseInt(o*this.heightRatio):1.5*parseInt(o*this.widthRatio)),this.defaults.fontSize=o;var n=10;1==i.adaption&&(n=this.widthRatio>this.heightRatio?parseInt(n*this.heightRatio):parseInt(n*this.widthRatio)),this.defaults.axisfontSize=n;var s=10;1==i.adaption&&(s=this.widthRatio>this.heightRatio?parseInt(s*this.heightRatio):parseInt(s*this.widthRatio)),this.defaults.axisPopSize=s,this.defaults.onSpecialColor=void 0,this.defaults.onClick=function(t){},this.defaults.onMouseOver=function(t){},this.defaults.onTouchStart=function(t){},this.defaults.onTouchEnd=function(t){},this.defaults.onMouseOut=function(t){},this.defaults.offset="expand",this.defaults.order="default",this.defaults.animateDuration=750,this.defaults.animateOrder=void 0,this.paths=void 0,this.source=void 0,this.layoutData=void 0,this.pathSource=void 0,this.defaults.level=0,this.defaults.axisHeight=30,this.defaults.percentageWidth=40,this.defaults.utils=a,this.defaults.customEventHandle={mousemove:null},this.setOptions(i),this.dimension={},0==this.defaults.showAxis&&(this.defaults.axisHeight=0),1==this.defaults.autoHeight&&this.defaults.heightWidthRatio&&(this.defaults.height=this.defaults.width*this.defaults.heightWidthRatio)}}));u.prototype._setColor=function(){if(this.defaults.gradientColor)this.owner.colorArray=0==this.owner.colorArray.length?s.setColor("gradient",this.defaults.gradientColor,this.layoutData.length):this.owner.colorArray;else{var t=this.owner.theme;this.owner.colorArray=0==this.owner.colorArray.length?s.getThemeColor(t):this.owner.colorArray}},u.prototype.setSource=function(t){this.chartSource=t.source,this.dimensions=t.dimensions,this.dimensionType=t.dimensionType,this.dimensionDomain=t.dimensionDomain,this.dimension.x=t.dimensions[0],this.dimension.type=t.dimensions[1],this.dimension.value=t.dimensions[2],this.dimension.info=t.dimensions[3];var e={};e[this.dimension.x]=0,e[this.dimension.type]=1,e[this.dimension.value]=2,e[this.dimension.info]=3;var i=this,s=this.defaults,r=this.dimension.x,h=o.groupBy(t.source,this.dimension.type);this.rowKeys=o.keys(h),this.columnKeys=o.keys(o.groupBy(t.source,r)),o.forEach(h,function(t,e){var n=o.pluck(h[e],r);o.each(i.columnKeys,function(t){if(-1===o.indexOf(n,t)){var a={};a[i.dimension.x]=t,a[i.dimension.type]=e,a[i.dimension.value]=0,h[e].push(a)}})}),this.rowCount=this.rowKeys.length,this.columnCount=this.columnKeys.length,this.sorted=o.sortBy(h,function(t){return 0-a.sum(t,i.dimension.value)}),o.forEach(this.sorted,function(t,e){i.sorted[e]=o.sortBy(t,r)}),o.forEach(h,function(t,e){h[e]=o.sortBy(t,r)}),this.groupedByX=o.groupBy(t.source,r),o.forEach(this.groupedByX,function(t,e){var n=o.pluck(i.groupedByX[e],i.dimension.type);o.each(i.rowKeys,function(t){if(-1===o.indexOf(n,t)){var a={};a[i.dimension.x]=e,a[i.dimension.type]=t,a[i.dimension.value]=0,i.groupedByX[e].push(a)}})}),o.forEach(this.groupedByX,function(t,e){i.groupedByX[e]=o.sortBy(t,i.dimension.type)}),this.groupedByType=h,o.each(this.sorted,function(t,e){i.groupedByType[t[0][i.dimension.type]].finalRank=e+1});var l=this.sorted.map(function(t){return t[0][i.dimension.type]});s.more?this.sortedText=n.more(l,s.level||0,s.max||20,function(){return s.moreLabel||"more"}):this.sortedText=l.slice(0),this.axisKey=this.columnKeys,this.remaped=this.remapSource(),this.layoutData=this.getLayoutData()},u.prototype.remapSource=function(){for(var t=this.sorted,e=[],i=0;i<this.columnCount;i++)for(var n=o.pluck(t,i),s=a.sum(n,this.dimension.value),r=0;r<this.rowCount;r++){if(e[r]=e[r]||[],e[r][i]={},e[r][i].x=i,t[r][i])var h=t[r][i][this.dimension.value]/s;else h=0;e[r][i].y=h}return e},u.prototype.getLayoutData=function(){var t=this.defaults,e=this.remaped,i=this;return t.more?n.more(e,t.level,t.max,function(t){for(var e=[],n=0;n<i.columnCount;n++)e.push({x:n,y:a.sum(o.pluck(t,n),"y")});return e}):e},u.prototype.layout=function(){this.paper=this.canvas,this._setColor();var t=this.defaults;a.d3.layout.stack().offset(t.offset).order(t.order)(this.layoutData)},u.prototype.generateChartElements=function(){var t=this.defaults,e=this.canvas,i=[],o=this.generateArea();n.vml,e.rect(0,0,t.width-35,t.height-t.axisHeight).attr({stroke:"none",fill:"#e0e0e0",opacity:0});for(var a=0,s=this.layoutData.length;a<s;a++){var r=o(this.pathSource[a]),h={};h.index=a,h[this.dimension.type]=this.sortedText[a];var l=this._getColor(h),u=e.path(r).attr({fill:l,stroke:l,"stroke-width":1}).data("rowIndex",a);i[a]=u}this.paths=i},u.prototype.render=function(t){"animate"!==t?(this.layout(),this.generateChartElements()):(this.layout(),this.animate()),this.hoverLine=this.own(new r),this.hoverLine.render(),this.defaults.pathLabel&&(this.pathLabel=this.own(new h),this.pathLabel.setSource(this.chartSource,this.dimension),this.pathLabel.render());var e={axisTextColor:this.defaults.axisTextColor,axisPopColor:this.defaults.axisPopColor,axisPopTextColor:this.defaults.axisPopTextColor};this.axis=this.own(new l(e)),this.axis.setSource(this.chartSource,this.dimension),this.axis.render(),this._initEvent()},u.prototype.animate=function(){var t,e,i,o,n,s,r=0,h=[],l=this.paths.length,u=this,d=function(){(l-=1)>0||u.animateCallback()};for(void 0!==this.defaults.animateDuration&&(r=this.defaults.animateDuration),void 0===this.paths&&this.generateChartElements(),t=this.generateArea(),n=void 0!==this.defaults.animateOrder?this.defaults.animateOrder:a.d3.range(this.pathSource.length),e=0,i=this.pathSource.length;e<i;e++)o=t(this.pathSource[e]),h.push(o);for(e=0,i=this.pathSource.length;e<i;e++){var c={};c.index=e,c[this.dimension.type]=this.sortedText[e],this._getColor(c),s=a.Raphael.animation({path:h[e]},r,d),this.paths[n[e]].animate(s)}},u.prototype.animateCallback=function(){var t=[],e=this;void 0!==this.defaults.animateOrder&&(this.defaults.animateOrder.forEach(function(i,o){t[o]=e.paths[i]}),this.paths=t)},u.prototype._getColor=function(t){var e=this.defaults,i=this.dimension.type,o=t[i];return this.owner.options.legend.data?(o=t[i=this.owner.options.legend.data],s.getColor(o,this.owner.colorDict,this.owner.colorArray)):s.getSpecialColor(e.onSpecialColor,t)||this.owner.colorArray[t.index]},u.prototype.getMaxY=function(){return a.d3.max(this.layoutData,function(t){return a.d3.max(t,function(t){return t.y0+t.y})})},u.prototype.mapPathSource=function(){var t=this.defaults,e=this.layoutData[0].length-1,i=this.getMaxY(),o=t.width-t.percentageWidth-35,n=t.height-t.axisHeight;this.pathSource=[];for(var a=0,s=this.layoutData.length;a<s;a++){this.pathSource[a]=[];for(var r=0,h=this.layoutData[0].length;r<h;r++){var l=this.layoutData[a][r],u=this.pathSource[a][r]={};u.x=l.x*o/e+t.percentageWidth,u.y0=n-l.y0*n/i,u.y=l.y*n/i}}},u.prototype.generateArea=function(){return this.mapPathSource(),a.d3.svg.area().x(function(t){return t.x.toFixed(0)}).y0(function(t){return t.y0.toFixed(0)}).y1(function(t){return(t.y0-t.y).toFixed(0)})},u.prototype.highlight=function(t){void 0!==t&&this.paths[t].attr({opacity:.5,"stroke-width":0})},u.prototype.lowlight=function(t){void 0!==t&&this.paths[t].attr({opacity:1,"stroke-width":1})},u.prototype.getTipContent=function(t,e){var i,s=this,r=this.defaults,h=o.map(this.groupedByX[this.axisKey[e]],function(t){return t[s.dimension.value]}).sort(function(t,e){return t>e?-1:1}),l=this.sorted;r.more?(i=n.more(l,r.level,r.max,function(t){for(var e=[],i=0;i<s.axisKey.length;i++){var n={};n[s.dimension.type]=r.moreLabel,n[s.dimension.x]=s.axisKey[i],n[s.dimension.value]=a.sum(o.pluck(t,i),s.dimension.value),e.push(n)}return e}),r.max<h.length&&((h=h.slice(0,r.max-1)).push(i[t][e][s.dimension.value]),h=h.sort(function(t,e){return t>e?-1:1}))):i=l;var u=i[t][e];return u&&void 0!==u.index&&delete u.index,u},u.prototype._initEvent=function(){var t=function(t,o,n){var a=e(i.canvas.canvas).offset(),s=(t.pageX||o)-a.left-i.defaults.percentageWidth,r=(t.pageY,a.top,i.pathSource,(s/((i.defaults.width-i.defaults.percentageWidth-35)/(i.columnCount-1)/2)+1)/2),h=Math.floor(r);return h=h>=i.columnCount?i.columnCount-1:h},i=this,o=null,a=0;this.animateCallback=function(){var t=[],e=this;void 0!==this.defaults.animateOrder&&(this.defaults.animateOrder.forEach(function(i,o){t[o]=e.paths[i]}),this.paths=t),i.cover.hidden(),i.pathLabel.show()};for(var s=function(e,o,n){i.hoverLine.show(),i.axis.showTab();var a={columnIndex:t(e,o,n),rowIndex:this.data("rowIndex")},s=i.getTipContent(a.rowIndex,a.columnIndex);s.index=a.rowIndex,i.highlight(a.rowIndex),i.defaults.onMouseOver(e,s),i.owner.legendSource&&i.fire("hoverIn",i.owner.legendSource[a.rowIndex]),i.preIndex=a.rowIndex},r=function(){i.hoverLine.hidden(),void 0!=i.preIndex&&(i.lowlight(i.preIndex),i.defaults.onMouseOut(i.preIndex),i.axis.hideTab(),i.owner.legendSource&&i.fire("hoverOut",i.owner.legendSource[i.preIndex]),i.floatTag&&i.floatTag.hide()),i.preIndex=void 0},h=function(e,o,n){var a={columnIndex:t(e,o,n),rowIndex:this.data("rowIndex")};i.floatTag&&i.floatTag.show(i.getTipContent(a.rowIndex,a.columnIndex)),i.axis.refreshTab(a.columnIndex),i.hoverLine.refresh(a.columnIndex,a.rowIndex),i.defaults.customEventHandle&&i.defaults.customEventHandle.mousemove&&i.defaults.customEventHandle.mousemove.call(i,{timeIndex:a.columnIndex,rowIndex:a.rowIndex})},l=0;l<this.paths.length;l++)this.paths[l].mouseover(s).mouseout(r).click(function(e,o,a){if(n.isMobile)return null;if(i.defaults.onClick){var s={columnIndex:t(e,o,a),rowIndex:this.data("rowIndex")},r=i.getTipContent(s.rowIndex,s.columnIndex);r.index=s.rowIndex,i.defaults.onClick(e,r)}}).mouseup(function(e,o,a){if(n.isMobile)return null;if(i.defaults.onMouseUp){var s={columnIndex:t(e,o,a),rowIndex:this.data("rowIndex")},r=i.getTipContent(s.rowIndex,s.columnIndex);r.index=s.rowIndex,i.defaults.onMouseUp(e,r)}}).touchstart(function(e,n,s){o&&clearTimeout(o),a=new Date,i.hoverLine.show(),i.axis.showTab();var r={columnIndex:t(e,e.touches[0].clientX,e.touches[0].clientY),rowIndex:this.data("rowIndex")};if((h=i.getTipContent(r.rowIndex,r.columnIndex)).index=r.rowIndex,i.highlight(r.rowIndex),i.defaults.onMouseOver(e,h),i.owner.legendSource&&i.fire("hoverIn",i.owner.legendSource[r.rowIndex]),i.preIndex=r.rowIndex,o=setTimeout(function(){i.hoverLine.hidden(),void 0!=i.preIndex&&(i.lowlight(i.preIndex),i.defaults.onMouseOut(e,i.preIndex),i.axis.hideTab(),i.owner.legendSource&&i.fire("hoverOut",i.owner.legendSource[i.preIndex]),i.floatTag&&i.floatTag.hide()),i.preIndex=void 0,o&&clearTimeout(o)},3e3),i.defaults.onTouchStart){var h;r={columnIndex:t(e,e.touches[0].clientX,e.touches[0].clientY),rowIndex:this.data("rowIndex")};(h=i.getTipContent(r.rowIndex,r.columnIndex)||{}).index=r.rowIndex,i.defaults.onTouchStart(e,h)}}).touchend(function(e,o,n){if(new Date-a<400){var s={columnIndex:t(e,e.touches[0].clientX,e.touches[0].clientY),rowIndex:this.data("rowIndex")};(r=i.getTipContent(s.rowIndex,s.columnIndex)).index=s.rowIndex,i.defaults.onClick(e,r)}if(!(new Date-a>500)&&i.defaults.onTouchEnd){var r;s={columnIndex:t(e,e.touches[0].clientX,e.touches[0].clientY),rowIndex:this.data("rowIndex")};(r=i.getTipContent(s.rowIndex,s.columnIndex)||{}).index=s.rowIndex,i.defaults.onTouchEnd(e,r)}}).mousemove(h);i.on("mouseover",function(t){i.highlight(t)}),i.on("mouseout",function(t){i.lowlight(t),i.defaults.onMouseOut(t)}),i.on("mousedblclick",function(t,e,i){this.defaults.onDblClick&&this.defaults.onDblClick(t,e,i)})},t.exports=u}(t)}).call(this,i(10)(t),i(18),i(16))},605:function(t,e,i){(function(t,e,o){
/*!***********************************************
Copyright (c) 2014, Neusoft Inc.
All rights reserved.
SaCa DataViz Version 2.0.0
************************************************/
!function(t){var n=i(531),a=i(563),s=i(561),r=n.extend(n.Chart,{initialize:function(t,i){this.type="RoseChart",this.node=this.checkContainer(t),this.defaults.width=800,this.defaults.height=800,this.defaults.innerRadius=100,this.defaults.arcRadius=25,this.defaults.padding=15,this.defaults.text="RoseChart",this.defaults.tickCount=5,this.defaults.sortType=3,this.defaults.animation=!0;var o=40;this.widthRatio=e(this.node).width()/this.defaults.width,this.heightRatio=e(this.node).height()/this.defaults.height,1==i.adaption&&(o=this.widthRatio>this.heightRatio?parseInt(o*this.heightRatio):parseInt(o*this.widthRatio)),this.defaults.textStyle={fill:"dodgerblue","font-size":o,"text-align":"middle","font-family":"Microsoft Yahei"};var n=16;if(1==i.adaption&&(n=this.widthRatio>this.heightRatio?parseInt(n*this.heightRatio):parseInt(n*this.widthRatio)),this.defaults.coordStyle={fill:"black","font-size":n,"text-anchor":"middle"},this.defaults.onClick=function(){},this.defaults.onMouseOver=function(){},this.defaults.onMouseOut=function(){},this.defaults.onTouchStart=function(){},this.defaults.onTouchEnd=function(){},this.defaults.onSpecialColor=void 0,this.setOptions(i),1==this.defaults.adaption){this.defaults.innerRadius=.15*Math.min(this.defaults.height,this.defaults.width),this.defaults.arcRadius=.05*Math.min(this.defaults.height,this.defaults.width);var a=.38*this.defaults.innerRadius;this.defaults.textStyle["font-size"]=a+"px"}this._initEvent(),this.source,this.dimension={}}});r.prototype._setColor=function(){var t=this.owner.theme;this.owner.colorArray=0==this.owner.colorArray.length?a.getThemeColor(t):this.owner.colorArray},r.prototype._initEvent=function(){var t=this,e=this.defaults,i=this.dimension;this.on("mouseclick",function(o,n){t.leafs.forEach(function(a){var s=t.owner.legendData||i.name;a.data("obj")[s]==n&&e.onClick&&e.onClick(o,a.data("obj"))})}),this.on("mousedblclick",function(t,i,o){e.onDblClick&&e.onDblClick(t,i,o)}),this.on("mouseup",function(o,n){t.leafs.forEach(function(a){var s=t.owner.legendData||i.name;a.data("obj")[s]==n&&e.onMouseUp&&e.onMouseUp(o,a.data("obj"))})}),this.on("mouseover",function(o,n,a){a=!(void 0!==a||!t.floatTag),t.leafs.forEach(function(s){var r=t.owner.legendData||i.name;s.data("obj")[r]==n&&(s.animate({"fill-opacity":.9},150),e.onMouseOver&&e.onMouseOver(o,s.data("obj")),a&&t.floatTag.show(s.data("obj"),{x:s.getBBox().x,y:s.getBBox().y}))}),t.fire("hoverIn",n)}),this.on("mouseout",function(o,n){t.leafs.forEach(function(a){var s=t.owner.legendData||i.name;a.data("obj")[s]==n&&(a.animate({"fill-opacity":.7},150),e.onMouseOut&&e.onMouseOut(o,a.data("obj")),t.floatTag&&t.floatTag.hide())}),t.fire("hoverOut",n)}),this.on("touchstart",function(o,n){t.leafs.forEach(function(a){var s=t.owner.legendData||i.name;a.data("obj")[s]==n&&e.onTouchStart&&e.onTouchStart(o,a.data("obj"))})}),this.on("touchend",function(o,n){t.leafs.forEach(function(a){var s=t.owner.legendData||i.name;a.data("obj")[s]==n&&e.onTouchEnd&&e.onTouchEnd(o,a.data("obj"))})})},r.prototype._layout=function(){var t=this,e=this.defaults,i=this.dimension,r=null,h=0,l=e.tickCount,u=e.width,d=e.height,c=e.innerRadius,f=e.arcRadius,m=Math.min(u,d)/2-e.padding,p=s.d3.scale.linear().range([0,2*Math.PI]),g=s.d3.scale.linear().range([0,m]);this._setColor();var v=o.clone(e.textStyle);v["font-size"]=v["font-size"]?parseInt(v["font-size"]):20,v["font-size"]=v["font-size"];var y=o.clone(e.coordStyle);y["font-size"]=y["font-size"]?parseInt(y["font-size"]):16,y["font-size"]=y["font-size"];var x=s.d3.svg.arc().startAngle(function(t){return Math.max(0,Math.min(2*Math.PI,p(t.x)))}).endAngle(function(t){return Math.max(0,Math.min(2*Math.PI,p(t.x+t.dx)))}).innerRadius(function(t){return Math.max(0,t.y?g(t.y):t.y)}).outerRadius(function(t){return Math.max(0,g(t.y+t.dy))}),w=(t.canvas.text(u/2,d/2,e.text).attr(v),t.source),b=0,k=0;switch(e.sortType){case 1:w=o.sortBy(w,function(t){return t[i.inneerSize]});break;case 2:w=o.sortBy(w,function(t){return t[i.outerSize]});break;case 3:w=o.sortBy(w,function(t){return t[i.outerSize]/t[i.innerSize]})}for(var S=0;S<w.length;S++)b+=w[S][i.innerSize],k+=w[S][i.outerSize];this.leafs=[];var C,M,D=[],T=this.dimensionDomain[i.outerSize][1],I=t.owner.legendData||i.name;g.domain([0,1]),D.x=0,D.dx=1,D.y=c/m,D.dy=D.y/15,t.canvas.path(x(D)).translate(u/2,d/2).attr({fill:"#666666","fill-opacity":.7,stroke:"#666666","stroke-opacity":0});for(S=0;S<w.length;S++){var z=t.colorIndex;z?z+=S:z=S,w[S].x=0===S?0:w[S-1].x+w[S-1].dx,w[S].dx=w[S][i.innerSize]/b,w[S].y=c/m,w[S].dy=f/m,C=x(w[S]);var O=this.createGeneralObj(w[S],i),B=function(o){var n=i.name,s=o[n];return t.owner.legendData?(s=o[n=t.owner.legendData],a.getColor(s,t.owner.colorDict,t.owner.colorArray)):a.getSpecialColor(e.onSpecialColor,o)||a.getColor(s,t.owner.colorDict,t.owner.colorArray)}(O);t.canvas.path(C).translate(u/2,d/2).attr({fill:B,"fill-opacity":.7,stroke:B,"stroke-opacity":0}).data("obj",O).mouseover(function(e){t.fire("mouseover",e,this.data("obj")[I])}).mouseout(function(e){t.fire("mouseout",e,this.data("obj")[I])}).click(function(e){if(n.isMobile)return null;t.fire("mouseclick",e,this.data("obj")[I])}).mouseup(function(e){if(n.isMobile)return null;t.fire("mouseup",e,this.data("obj")[I])}).touchstart(function(e){if(h=new Date,n.isMobile){r&&clearTimeout(r);var i=this.data("obj")[I];t.floatTag&&t.floatTag.hide(),t.fire("mouseover",e,i),r=setTimeout(function(){t.fire("mouseout",e,i),r&&clearTimeout(r)},3e3)}t.fire("touchstart",e,this.data("obj")[I])}).touchend(function(e){new Date-h<400&&t.fire("mouseclick",e,this.data("obj")[I]),new Date-h>500||t.fire("touchend",e,this.data("obj")[I])}),M=t.canvas.path().translate(u/2,d/2).attr({fill:B,"fill-opacity":.7,stroke:B,"stroke-opacity":0}).data("obj",O).mouseover(function(e){if(n.isMobile)return null;t.fire("mouseover",e,this.data("obj")[I])}).mouseout(function(e){if(n.isMobile)return null;t.fire("mouseout",e,this.data("obj")[I])}).click(function(e){if(n.isMobile)return null;t.fire("mouseclick",e,this.data("obj")[I])}).mouseup(function(e){if(n.isMobile)return null;t.fire("mouseup",e,this.data("obj")[I])}).touchstart(function(e){h=new Date;var i=this.data("obj")[I];r&&clearTimeout(r),t.floatTag&&t.floatTag.hide(),t.fire("mouseover",e,i),r=setTimeout(function(){t.fire("mouseout",e,i),r&&clearTimeout(r)},3e3),t.fire("touchstart",e,this.data("obj")[I])}).touchend(function(e){if(new Date-h<400)t.fire("mouseclick",e,this.data("obj")[I]);else if(new Date-h>500)return;t.fire("touchend",e,this.data("obj")[I])}),w[S].y=c/m+f/m,w[S].dy=w[S][i.outerSize]/T*(m-c-f)/m,C=x(w[S]),s.setAnimation(this.defaults.animation,M,{path:C},200),this.leafs.push(M)}var j=u/2+g(c/m+f/m),N=g((m-c-f)/m),_="M"+j+","+d/2+" L"+(j+N)+","+d/2;t.canvas.path(_).attr({stroke:y.fill,"stroke-width":"0.5px"});var R=s.tickRange(0,T,l);l=R.length;var E,L,A=j,F=d/2-5,P=A,H=d/2,Y=u/2-g(c/m+f/m),G=d/2,V=ry=A-u/2,W=(N-(T-R[R.length-1])*m/k/1)/(l-1);for(S=0;S<l;S++)E="M"+A+","+d/2+"L"+A+","+F,L="M"+P+","+H+" A"+V+","+ry+" 0 0,0 "+Y+","+G,t.canvas.path(E).attr({stroke:y.fill,"stroke-width":"0.5px"}),t.canvas.path(L).attr({stroke:y.fill,"stroke-width":"0.2px"}),A+=W,P+=W,Y-=W,V=ry=V+W;for(S=l-1;S>=0;S--)A-=W,t.canvas.text(A,d/2+10,s.tickFormat(R[S])).attr(y)},r.prototype.render=function(){this._layout()},r.prototype.setSource=function(t){this.source=t.source,this.dimensions=t.dimensions,this.dimensionType=t.dimensionType,this.dimensionDomain=t.dimensionDomain,this.dimension.name=t.dimensions[0],this.dimension.innerSize=t.dimensions[1],this.dimension.outerSize=t.dimensions[2],this.dimension.info=t.dimensions[3]},t.exports=r}(t)}).call(this,i(10)(t),i(18),i(16))},606:function(t,e,i){(function(t,e,o){
/*!***********************************************
Copyright (c) 2014, Neusoft Inc.
All rights reserved.
SaCa DataViz Version 2.0.0
************************************************/
!function(t){var n=i(531),a=i(561),s=i(563),r=n.extend(n.Chart,{initialize:function(t,e){this.type="PinterestChart",this.node=this.checkContainer(t),this.defaults.width=400,this.defaults.height=400,this.defaults.showCategory=!1,this.defaults.onSpecialColor=void 0,this.defaults.onClick=function(t){},this.defaults.onMouseOver=function(t){},this.defaults.onMouseOut=function(t){},this.defaults.showBackground=!0,this.defaults.backGroundColor="#F3ECF4",this.defaults.textColor="#544b68",this.defaults.backgroundOpacity=.4,this.defaults.categoryBackgroundOpacity=.4,this.defaults.categoryOpactiy=.5,this.defaults.subCategoryOpacity=.4,this.defaults.animation=!0,this.setOptions(e),this.cirPosition,this.sub_cirPosition,this.source,this.sourceType=2,this.canvas,this.isRendered=!1,this._initEvent(),this.dimension={}}});function h(t){this.r=t.r,this.x=t.x,this.y=t.y,this.info=t.info,this.elementR,this.child=t.child||[],this.element=t.element||[]}function l(t){this.prnt=t.prnt,this.theta=t.theta,this.x=t.x,this.y=t.y,this.r=t.r,this.ratio=t.ratio,this.group=t.group,this.idx=t.idx,this.stage=t.stage,this.isUnderMouse=!1,this.isSelected=!1,this.blink=t.blink,this.alpha=1,t.blink?this.alphaV=-(.02*Math.random()+.01):this.alphaV=0}r.prototype._setColor=function(){var t=this.owner.theme;this.owner.colorArray=0==this.owner.colorArray.length?s.getThemeColor(t):this.owner.colorArray},r.prototype._getColor=function(t,e){var i=this.defaults,o=t[e];return s.getSpecialColor(i.onSpecialColor,t)||s.getColor(o,this.owner.colorDict,this.owner.colorArray)},r.prototype.backClick=function(){if(this.subCirSet.remove(),this.cirSet.show(),n.vml)return!1},r.prototype._initEvent=function(){var t=this;this.on("mouseclick",function(t){this.cirSet.hide();for(var i={},o={x:this.defaults.width/2,y:this.defaults.height/2,r:e.min([this.defaults.width,this.defaults.height])/3},n=0;n<this.source.type.length;n++){var a=this.source.type[n];if(a[this.dimension.group]==t[this.dimension.group]){this.sub_calculateLocation(this.source.type[n],1,o),i=this.source.type[n];break}for(var s=0;s<a.element.length;s++)if(a.element[s][this.dimension.name]==t[this.dimension.name]){this.sub_calculateLocation(this.source.type[n],1,o),i=this.source.type[n];break}}this.drawSubCircle(this.sub_cirPosition.child),this.defaults.onClick(i)}),this.on("mouseover",function(){var e=arguments[0][t.dimension.name],i=arguments[0][t.dimension.group],o=arguments[1],n=arguments[2];n=!(void 0!==n||!t.floatTag);var a="0.4";(1==t.sourceType?t.subCirSet:t.cirSet).forEach(function(s){e?s.data("obj")&&s.data("obj")[t.dimension.group]==i&&s.data("text")==e&&("text"==s.type?a="1.0":1==o&&"circle"==s.type?a=t.defaults.categoryBackgroundOpacity:2==o&&"circle"==s.type?a=Math.min(t.defaults.categoryOpactiy+.2,1):3==o&&"circle"==s.type&&(a=Math.min(t.defaults.subCategoryOpacity+.2,.7)),s.animate({opacity:a},500),n&&t.floatTag.show(s.data("obj"),{x:s.getBBox().x,y:s.getBBox().y})):s.data("obj")&&!s.data("obj")[t.dimension.name]&&s.data("obj")[t.dimension.group]==i&&"text"==s.type&&(t.defaults.showCategory||(a="1.0",s.animate({opacity:a},500)),n&&t.floatTag.show(s.data("obj"),{x:s.getBBox().x,y:s.getBBox().y}))})}),this.on("mouseout",function(){var e=arguments[0][t.dimension.name],i=arguments[0][t.dimension.group],o=arguments[1],n="0.5";(1==t.sourceType?t.subCirSet:t.cirSet).forEach(function(a){e?a.data("obj")&&a.data("obj")[t.dimension.group]==i&&a.data("text")==e&&(1==o&&"text"==a.type?n="0.0":1==o&&"circle"==a.type?n=t.defaults.categoryBackgroundOpacity:2==o&&"circle"==a.type?n=t.defaults.categoryOpactiy:1!=o&&"text"==a.type?n="1.0":3==o&&"circle"==a.type&&(n=t.defaults.subCategoryOpacity),a.animate({opacity:n},500),t.floatTag&&t.floatTag.hide()):a.data("obj")&&!a.data("obj")[t.dimension.name]&&a.data("obj")[t.dimension.group]==i&&1==o&&"text"==a.type&&(t.defaults.showCategory||(n="0.0",a.animate({opacity:n},500)),t.floatTag&&t.floatTag.hide())})}),this.on("mousedblclick",function(t,e,i){this.defaults.onDblClick&&this.defaults.onDblClick(t,e,i)}),n.svg&&o(document).bind("contextmenu.pinterest",function(t){return!1})},r.prototype._layout=function(){this._setColor(),this.calculateLocation(),1==this.sourceType?this.drawSubCircle(this.cirPosition.child):this.drawCircle(this.cirPosition)},r.prototype.calculateLocation=function(){var t=this,i=this.source,o=this.defaults,n=o.width,a=o.height,s=e.min([o.width,o.height])/3,r=o.width/3;if(bigDrip=new h({r:1.06*s,x:n/2,y:a/2,info:{type:"TOPDRIP",count:i.total}}),bigDrip.elementR=Math.floor(s/Math.sqrt(6*r)),void 0===i)throw new Error("DataViz Error # Source Error : Please specify correct source.");for(var l=i.type,u=0;u<l.length;u++)l[u].idx=u;l.sort(function(e,i){return e[t.dimension.value]===i[t.dimension.value]?0:e[t.dimension.value]<i[t.dimension.value]?1:-1});var d=2*Math.PI*Math.random(),c=1,f=-1,m=Math.PI,p=0;for(u=0;u<l.length&&0!==l[u][t.dimension.value];u++)p++;for(u=0;u<p&&0!==l[u][t.dimension.value];u++,f++){f===c&&(f=0,d-=Math.PI/2/c,m=Math.PI/c,c>=2&&(m+=Math.PI),c*=2),d+=m;var g={},v=l[u][t.dimension.value]/i.total;v<.005&&(v=.005),g.r=Math.sqrt(v)*s;var y=g.r+.1,x=g.r/5>10?g.r/5:10;do{g.x=bigDrip.x+y*Math.cos(d),g.y=bigDrip.y+y*Math.sin(d),y+=x}while(bigDrip.collide(g));if(u>0)do{y-=2,g.x=bigDrip.x+y*Math.cos(d),g.y=bigDrip.y+y*Math.sin(d)}while(!bigDrip.collide(g)&&y>-1e3);y+=2,g.x=bigDrip.x+y*Math.cos(d),g.y=bigDrip.y+y*Math.sin(d),g.info={},g.info[t.dimension.group]=l[u][t.dimension.group],g.info[t.dimension.value]=l[u][t.dimension.value],g.info[t.dimension.info]=l[u][t.dimension.info],g.info["百分比"]=Math.round(l[u][t.dimension.value]/i.total*100)+"%";var w=new h(g);bigDrip.child[bigDrip.child.length]=w}if(1===p)bigDrip.child[0].x=bigDrip.x,bigDrip.child[0].y=bigDrip.y,bigDrip.child[0].refreshShape();else if(2===p){var b=bigDrip.child[0],k=bigDrip.child[1];if(b.r+k.r>bigDrip.r){var S=(b.x*b.r+k.x*k.r)/(b.r+k.r),C=(b.y*b.r+k.y*k.r)/(b.r+k.r),M=S-bigDrip.x,D=C-bigDrip.y;for(u=0;u<p;u++)bigDrip.child[u].x-=M,bigDrip.child[u].y-=D,bigDrip.child[u].refreshShape()}}else if(p>2){var T=1e3,I=-1e3,z=1e3,O=-1e3;for(u=0;u<p;u++){var B=bigDrip.child[u];B.x-B.r<T&&(T=B.x-B.r),B.x+B.r>I&&(I=B.x+B.r),B.y-B.r<z&&(z=B.y-B.r),B.y+B.r>O&&(O=B.y+B.r)}for(M=(T+I)/2-bigDrip.x,D=(z+O)/2-bigDrip.y,u=0;u<p;u++)bigDrip.child[u].x-=M,bigDrip.child[u].y-=D,bigDrip.child[u].refreshShape()}for(u=0;u<p;u++)if(0!=l[u].element.length){var j={x:bigDrip.child[u].x,y:bigDrip.child[u].y,r:.7*bigDrip.child[u].r};bigDrip.child[u].element=t.sub_calculateLocation(l[u],2,j).child}this.cirPosition=bigDrip},r.prototype.sub_calculateLocation=function(t,e,i){var o=this,n=t,a=i.x,s=i.y,r=i.r,l=i.r;if(subDrip=new h({r:1.06*r,x:a,y:s}),subDrip.info={},subDrip.info.type="TOPDRIP",subDrip.info[o.dimension.value]=n[o.dimension.value],subDrip.elementR=Math.floor(r/Math.sqrt(6*l)),void 0===n)throw new Error("DataViz Error # Source Error : Please specify correct source.");for(var u=n.element,d=0;d<u.length;d++)u[d].idx=d;u.sort(function(t,e){return t[o.dimension.value]===e[o.dimension.value]?0:t[o.dimension.value]<e[o.dimension.value]?1:-1});var c=2*Math.PI*Math.random(),f=1,m=-1,p=Math.PI,g=0;for(d=0;d<u.length&&0!==u[d].value;d++)g++;for(d=0;d<g&&0!==u[d][o.dimension.value];d++,m++){m===f&&(m=0,c-=Math.PI/2/f,p=Math.PI/f,f>=2&&(p+=Math.PI),f*=2),c+=p;i={};var v=u[d][o.dimension.value]/n[o.dimension.value];v<.005&&(v=.005),i.r=Math.sqrt(v)*r;var y=i.r+.1,x=i.r/5>10?i.r/5:10;do{i.x=subDrip.x+y*Math.cos(c),i.y=subDrip.y+y*Math.sin(c),y+=x}while(subDrip.collide(i));if(d>0)do{y-=2,i.x=subDrip.x+y*Math.cos(c),i.y=subDrip.y+y*Math.sin(c)}while(!subDrip.collide(i)&&y>-1e3);y+=2,i.x=subDrip.x+y*Math.cos(c),i.y=subDrip.y+y*Math.sin(c),i.info={},i.info[o.dimension.group]=u[d][o.dimension.group],i.info[o.dimension.name]=u[d][o.dimension.name],i.info[o.dimension.value]=u[d][o.dimension.value],i.info[o.dimension.info]=u[d][o.dimension.info],i.info["百分比"]=Math.round(u[d][o.dimension.value]/n[o.dimension.value]*100)+"%";var w=new h(i);if(void 0!==u[d].element){var b=n[o.dimension.value]>l;w.setElements(u[d].element,b)}subDrip.child[subDrip.child.length]=w}if(1===g)subDrip.child[0].x=subDrip.x,subDrip.child[0].y=subDrip.y,subDrip.child[0].refreshShape();else if(2===g){var k=subDrip.child[0],S=subDrip.child[1];if(k.r+S.r>subDrip.r){var C=(k.x*k.r+S.x*S.r)/(k.r+S.r),M=(k.y*k.r+S.y*S.r)/(k.r+S.r),D=C-subDrip.x,T=M-subDrip.y;for(d=0;d<g;d++)subDrip.child[d].x-=D,subDrip.child[d].y-=T,subDrip.child[d].refreshShape()}}else if(g>2){var I=1e3,z=-1e3,O=1e3,B=-1e3;for(d=0;d<g;d++){var j=subDrip.child[d];j.x-j.r<I&&(I=j.x-j.r),j.x+j.r>z&&(z=j.x+j.r),j.y-j.r<O&&(O=j.y-j.r),j.y+j.r>B&&(B=j.y+j.r)}for(D=(I+z)/2-subDrip.x,T=(O+B)/2-subDrip.y,d=0;d<g;d++)subDrip.child[d].x-=D,subDrip.child[d].y-=T,subDrip.child[d].refreshShape()}if(1==e)o.sub_cirPosition=subDrip;else if(2==e)return subDrip},h.prototype={setElements:function(t,e){if(0===this.child.length)for(var i=[],o=[],n=0;n<t.length;n++){var a,s,r,h,u=0,d=3*this.elementR;do{a=Math.random()*(this.r-2*this.elementR),s=2*Math.PI*Math.random(),r=a*Math.cos(s),h=a*Math.sin(s),++u>20&&(d-=this.elementR,u=0)}while(c(r,h,d));this.element[this.element.length]=new l({prnt:this,theta:s,ratio:a/this.r,r:a,x:r,y:h,group:t,idx:n,info:t[n],blink:e}),i[i.length]=r,o[o.length]=h}function c(t,e,n){for(var a=0;a<i.length;a++)if(Math.pow(t-i[a],2)+Math.pow(e-o[a],2)<Math.pow(n,2))return!0;return!1}},refreshShape:function(){this.repulsionParam=Math.pow(this.r,10)*Math.pow(this.theta,2)*2*Math.cos((Math.PI-this.theta)/2)},collide:function(t){for(var e=t,i=0;i<this.child.length;i++)if(this.testBallCollide(e,this.child[i]))return!0;return!1},testBallCollide:function(t,e){return!(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)>=Math.pow(t.r+e.r,2))}},r.prototype.drawCircle=function(){var t=this,e=0,i=null,s=this.defaults.backGroundColor;t.defaults.showBackground||(s="none");var r=this.canvas.circle(this.cirPosition.x,this.cirPosition.y,1.25*this.cirPosition.r).attr({fill:s,opacity:this.defaults.backgroundOpacity,stroke:"none"}).click(function(e){if(n.isMobile)return null;t.backClick()}).touchstart(function(e){t.backClick()});o(r.node).bind("contextmenu",function(e){t.backClick()}),t.cirSet.push(r);for(var h=0;h<this.cirPosition.child.length;h++){for(var l=this.cirPosition.child[h],u=l.x,d=l.y,c=l.r,f=l.info[t.dimension.group],m=this._getColor(this.cirPosition.child[h].info,t.dimension.group),p=this.canvas.circle(u,d,c).attr({fill:m,opacity:this.defaults.categoryBackgroundOpacity,stroke:"none"}).data("i",h).data("r",c).data("x",u).data("y",d).click(function(e){if(n.isMobile)return null;t.fire("mouseclick",this.data("obj"))}).touchstart(function(e){t.fire("mouseclick",this.data("obj"))}).data("obj",l.info).data("text",f).mouseover(function(e){t.fire("mouseover",this.data("obj"),1),t.defaults.onMouseOver(e,this.data("obj"))}).mouseout(function(e){t.fire("mouseout",this.data("obj"),1),t.defaults.onMouseOut(e,this.data("obj"))}).touchstart(function(o){e=new Date;var n=this.data("obj");i&&clearTimeout(i),t.floatTag&&t.floatTag.hide(),t.fire("mouseover",n,1),t.defaults.onMouseOver(o,n),i=setTimeout(function(){t.fire("mouseout",n,1),t.defaults.onMouseOut(o,n),i&&clearTimeout(i)},3e3)}).touchend(function(i){if(new Date-e<400)t.fire("mouseclick",this.data("obj"));else if(new Date-e>500)return}),g=0;g<l.element.length;g++){var v=l.element[g].x,y=l.element[g].y,x=l.element[g].r,w=l.element[g].info[t.dimension.name],b=this.canvas.circle(v,y,0).attr({fill:m,opacity:this.defaults.categoryOpactiy,stroke:"none"}).data("i",h).data("obj",l.element[g].info).data("text",w).mouseover(function(e){t.fire("mouseover",this.data("obj"),2),t.defaults.onMouseOver(e,this.data("obj"))}).mouseout(function(e){t.fire("mouseout",this.data("obj"),2),t.defaults.onMouseOut(e,this.data("obj"))}).click(function(){if(n.isMobile)return null;t.fire("mouseclick",this.data("obj"))}).touchstart(function(){e=new Date;var o=this.data("obj");i&&clearTimeout(i),t.floatTag&&t.floatTag.hide(),t.fire("mouseover",o,2),t.defaults.onMouseOver(event,o),i=setTimeout(function(){t.fire("mouseout",o,2),t.defaults.onMouseOut(event,o),i&&clearTimeout(i)},3e3)}).touchend(function(i){if(new Date-e<400)t.fire("mouseclick",this.data("obj"));else if(new Date-e>500)return});if(a.setAnimation(this.defaults.animation,b,{r:x},300),t.cirSet.push(b),x/4>5){var k=t.canvas.text(v,y,w).attr({"font-family":"Microsoft Yahei","font-size":Math.floor(x/2.5)+"px",fill:t.defaults.textColor}).data("i",h).data("text",w).data("obj",l.element[g].info).mouseover(function(e){t.fire("mouseover",this.data("obj"),2),t.defaults.onMouseOver(e,this.data("obj"))}).mouseout(function(e){t.fire("mouseout",this.data("obj"),2),t.defaults.onMouseOut(e,this.data("obj"))}).click(function(e){if(n.isMobile)return null;t.fire("mouseclick",this.data("obj"))}).touchstart(function(o){e=new Date;var n=this.data("obj");i&&clearTimeout(i),t.floatTag&&t.floatTag.hide(),t.fire("mouseover",n,2),t.defaults.onMouseOver(o,n),i=setTimeout(function(){t.fire("mouseout",n,2),t.defaults.onMouseOut(o,n),i&&clearTimeout(i)},3e3)}).touchend(function(i){if(new Date-e<400)t.fire("mouseclick",this.data("obj"));else if(new Date-e>500)return});t.cirSet.push(k)}}var S=l.info[t.dimension.group],C=this.canvas.text(u,d,S).attr({opacity:"0.0","font-weight":"bold","font-family":"Microsoft Yahei","font-size":Math.floor(c/3)+"px",fill:t.defaults.textColor}).data("i",h).data("obj",l.info).data("text",f).mouseover(function(e){t.fire("mouseover",this.data("obj"),1),t.defaults.onMouseOver(e,this.data("obj"))}).mouseout(function(e){t.fire("mouseout",this.data("obj"),1),t.defaults.onMouseOut(e,this.data("obj"))}).click(function(e){if(n.isMobile)return null;t.fire("mouseclick",this.data("obj"))}).touchstart(function(o){e=new Date;var n=this.data("obj");i&&clearTimeout(i),t.floatTag&&t.floatTag.hide(),t.fire("mouseover",n,1),t.defaults.onMouseOver(o,n),i=setTimeout(function(){t.fire("mouseout",n,1),t.defaults.onMouseOut(o,n),i&&clearTimeout(i)},3e3)}).touchend(function(i){if(new Date-e<400)t.fire("mouseclick",this.data("obj"));else if(new Date-e>500)return});t.defaults.showCategory&&C.attr("opacity",1),t.cirSet.push(p,C)}},r.prototype.drawSubCircle=function(t){var e=this,i=0,a=null,s=this.defaults.backGroundColor;e.defaults.showBackground||(s="none"),1==e.sourceType&&this.canvas.circle(this.cirPosition.x,this.cirPosition.y,1.25*this.cirPosition.r).attr({fill:s,opacity:this.defaults.backgroundOpacity,stroke:"none"});for(var r=0;r<t.length;r++){var h=t[r],l=h.x,u=h.y,d=h.r,c=h.info[e.dimension.name],f=e._getColor(t[r].info,e.dimension.name),m=this.canvas.circle(l,u,d).attr({fill:f,stroke:"none",opacity:this.defaults.subCategoryOpacity}).data("i",r).data("obj",h.info).data("text",c).mouseover(function(t){e.fire("mouseover",this.data("obj"),3),e.defaults.onMouseOver(t,this.data("obj"))}).mouseout(function(t){e.fire("mouseout",this.data("obj"),3),e.defaults.onMouseOut(t,this.data("obj"))}).click(function(t){if(n.isMobile)return null;e.backClick()}).touchstart(function(t){i=new Date;var o=this.data("obj");a&&clearTimeout(a),e.floatTag&&e.floatTag.hide(),e.fire("mouseover",o,3),e.defaults.onMouseOver(t,o),a=setTimeout(function(){e.fire("mouseout",o,3),e.defaults.onMouseOut(t,o),a&&clearTimeout(a)},3e3)}).touchend(function(t){if(new Date-i<400)e.backClick();else if(new Date-i>500)return}),p=(c=h.info[e.dimension.name],this.canvas.text(l,u,c).attr({"font-family":"Microsoft Yahei","font-size":Math.floor(d/3)+"px",fill:e.defaults.textColor}).data("i",r).data("obj",h.info).data("text",c).mouseover(function(t){e.fire("mouseover",this.data("obj")),e.defaults.onMouseOver(t,this.data("obj"))}).mouseout(function(t){e.fire("mouseout",this.data("obj")),e.defaults.onMouseOut(t,this.data("obj"))}).click(function(t){if(n.isMobile)return null;e.backClick()}).touchstart(function(t){i=new Date}).touchend(function(t){if(new Date-i<400)e.backClick();else if(new Date-i>500)return}));2==e.sourceType&&(o(p.node).bind("contextmenu",function(t){e.backClick()}),o(m.node).bind("contextmenu",function(t){e.backClick()})),e.subCirSet.push(m,p)}},r.prototype.setSource=function(t){this.source=t.source,this.dimensions=t.dimensions,this.dimensionType=t.dimensionType,this.dimensionDomain=t.dimensionDomain,this.dimension.group=t.dimensions[0],this.dimension.name=t.dimensions[1],this.dimension.value=t.dimensions[2],this.dimension.info=t.dimensions[3];for(var e={type:[],total:0},i=[],n=0;n<this.source.length;n++){var a=this.source[n][this.dimension.group],s=this.source[n][this.dimension.name],r=this.source[n][this.dimension.value],h=this.source[n][this.dimension.info];if(e.total+=r,void 0===s){this.sourceType=1,(f={})[this.dimension.group]=a,f[this.dimension.value]=r,f[this.dimension.info]=h,f.element=[],e.type.push(f),(d={})[this.dimension.group]=a,d[this.dimension.name]=s,d[this.dimension.value]=r,d[this.dimension.info]=h,f.element.push(d)}else{if(-1==o.inArray(a,i))(f={})[this.dimension.group]=a,f[this.dimension.value]=0,f.element=[],i.push(a),e.type.push(f);for(var l=0;l<i.length;l++){var u=null;if(e.type[l][this.dimension.group]==a&&(u=e.type[l].element),u){var d;(d={})[this.dimension.group]=a,d[this.dimension.name]=s,d[this.dimension.value]=r,d[this.dimension.info]=h;for(var c=0;c<e.type.length;c++){var f;if((f=e.type[c]).element==u){f[this.dimension.value]+=r;break}}u.push(d)}}}}this.source=e},r.prototype.render=function(){this.cirSet=this.canvas.set(),this.subCirSet=this.canvas.set(),this._layout()},t.exports=r}(t)}).call(this,i(10)(t),i(16),i(18))},607:function(t,e,i){(function(t,e,o){
/*!***********************************************
 Copyright (c) 2014, Neusoft Inc.
 All rights reserved.
 SaCa DataViz Version 2.0.0
 ************************************************/
!function(t){var n=i(531),a=i(563),s=i(561),r=n.extend(n.Chart,{initialize:function(t,i){this.type="HotmapChart",this.node=this.checkContainer(t),this.defaults.width=800,this.defaults.height=500,this.defaults.padding={top:30,bottom:0,left:40,right:20};var o=12;this.widthRatio=e(this.node).width()/this.defaults.width,this.heightRatio=e(this.node).height()/this.defaults.height,this.widthRatio>1&&this.heightRatio>1&&1==i.adaption&&(o=this.widthRatio>this.heightRatio?parseInt(o*this.heightRatio):parseInt(o*this.widthRatio)),this.defaults.rowLabelStyle={"font-size":o,"font-family":"Microsoft Yahei"};var n=12;this.widthRatio=e(this.node).width()/this.defaults.width,this.heightRatio=e(this.node).height()/this.defaults.height,this.widthRatio>1&&this.heightRatio>1&&1==i.adaption&&(n=this.widthRatio>this.heightRatio?parseInt(n*this.heightRatio):parseInt(n*this.widthRatio)),this.defaults.colLabelStyle={"font-size":n,"font-family":"Microsoft Yahei"},this.defaults.colRotate=0,this.defaults.onSpecialColor=void 0,this.defaults.defaultColor="black",this.defaults.onClick=function(t){},this.defaults.onMouseOver=function(t){},this.defaults.onMouseOut=function(t){},this.defaults.onTouchStart=function(t){},this.defaults.onTouchEnd=function(t){},this.setOptions(i),this.source,this.dimension={}}});r.prototype._setColor=function(){var t=this.owner.theme;this.owner.colorArray=0==this.owner.colorArray.length?a.getThemeColor(t):this.owner.colorArray;var e=this.owner.colorDict,i=this.owner.colorArray,n=this.owner.themeColor;0==e.length&&o.each(this.owner.legendSource,function(t){var o=a.getColor(t,e,i,n,"random");e.push({name:t,color:o})})},r.prototype._getColor=function(t){var e=this.defaults,i=this.dimension.value,n=t[i];if(this.owner.legendData&&!o.isArray(this.owner.legendData))return n=t[i=this.owner.legendData],a.getColor(n,this.owner.colorDict,this.owner.colorArray);var s=a.getSpecialColor(e.onSpecialColor,t)||a.getColor(n,this.owner.colorDict,this.owner.colorArray,!0);return"black"===s?this.defaults.defaultColor:s},r.prototype._paintColLabel=function(t,e,i,o,n){for(var a=this.canvas,s=1;s<o.length;s++){var r=a.text((o[s]+o[s-1])/2,t,i[s-1]).attr(this.defaults.colLabelStyle);if(this.defaults.colRotate){var h=r.getBBox(!0),l=h.x2-h.width,u=h.y2;r.transform("t"+h.width/2+",0r-"+this.defaults.colRotate+" "+l+","+u)}}},r.prototype._paintRect=function(t,e,i,n,a){for(var s=this.canvas,r=this.source,h=this.rectNode,l=0,u=0;u<r.length;u++){var d=r[u],c=o.indexOf(this.colArray,d[this.dimension.col]),f=o.indexOf(this.rowArray,d[this.dimension.row]),m=d[this.dimension.value],p={};if(p[this.dimension.value]=m,p[this.dimension.col]=n[c],p[this.dimension.row]=a[f],p.opacity=.5,p[this.dimension.info]=d[this.dimension.info],void 0!=m&&""!=m){var g=this._getColor(p),v=s.rect((e[c+1]+e[c])/2-t/2,i[f]-t/2,0,0,3).attr({stroke:"none",fill:g,"fill-opacity":.5}).animate({width:t,height:t},500).data("obj",p);h.push(v),l_str=a[f],l_str.length>=8&&(l_str=l_str.slice(0,8)+"..."),l==f&&(s.text(2*e[0]-e[1],i[f],l_str).attr({"text-anchor":"start"}).attr(this.defaults.rowLabelStyle),l=f+1)}}},r.prototype.highlight=function(t){var e=this.owner.legendSource,i=void 0;if(e)for(var o=0;o<e.length;o++)if(e[o]==t){i=o;break}for(var n=this.rectNode,a=0;a<n.length;a++){var r=-1;try{r=s.getIndexOfValueRange(this.owner.legendData,n[a].data("obj")[this.dimension.value])}catch(t){r=e.length}r==i?n[a].attr({"fill-opacity":1}):n[a].attr({"fill-opacity":.1})}},r.prototype.lowlight=function(t,e){for(var i=this.rectNode,o=0;o<i.length;o++)i[o].attr({"fill-opacity":.5})},r.prototype.mousedblclick=function(t,e,i){this.defaults.onDblClick&&this.defaults.onDblClick(t,e,i)},r.prototype._layout=function(t){this._setColor();var e=this,i=null,o=0,a=this.defaults.width,s=this.defaults.height,r=this.defaults.padding,h=this.userDef,l=this.floatTag,u=this.colArray,d=this.rowArray;this.rectNode=[];var c=function(t,e,i){var o=[];mean=parseFloat(1*(e-t)/i);for(var n=1;n<=i;n++)o.push(t+n*mean);return o},f=s,m=c(r.left,a-r.right,h.col+1),p=c(0*f+r.top,1*f-r.bottom,h.row+1),g=.9*(m[1]-m[0]),v=.9*(p[1]-p[0]),y=Math.min(g,v),x=p[1]-p[0],w=0*f+r.top+.2*x;this._paintColLabel(w,f,u,m,r),this._paintRect(y,m,p,u,d);for(var b=this.rectNode,k=0;k<b.length;k++)b[k].mouseover(function(t){var i=e.createGeneralObj(this.data("obj"),e.dimensions);this.attr("cursor","pointer"),l&&l.show(i),this.animate({"fill-opacity":1},150),e.defaults.onMouseOver(t,i)}).mouseout(function(t){var i=e.createGeneralObj(this.data("obj"),e.dimensions);l&&l.hide(),this.data("obj").opacity&&this.animate({"fill-opacity":this.data("obj").opacity},150),e.defaults.onMouseOut(t,i)}).click(function(t){if(n.isMobile)return null;var i=e.createGeneralObj(this.data("obj"),e.dimensions);e.defaults.onClick(t,i)}).mouseup(function(t){if(n.isMobile)return null;var i=e.createGeneralObj(this.data("obj"),e.dimensions);e.defaults.onMouseUp(t,i)}).touchstart(function(t){o=new Date;var a=e.createGeneralObj(this.data("obj"),e.dimensions);e.floatTag&&e.floatTag.hide(),n.isMobile&&(i&&clearTimeout(i),this.attr("cursor","pointer"),l&&l.show(a),this.animate({"fill-opacity":1},150),e.defaults.onMouseOver(t,a),i=setTimeout(function(){e.data("obj").opacity&&e.animate({"fill-opacity":e.data("obj").opacity},150),e.defaults.onMouseOut(t,a),i&&clearTimeout(i)},3e3)),e.defaults.onTouchStart(t,a)}).touchend(function(t){var i=e.createGeneralObj(this.data("obj"),e.dimensions);new Date-o<400&&e.defaults.onClick(t,i),new Date-o>500||e.defaults.onTouchEnd(t,i)})},r.prototype.render=function(){this._layout()},r.prototype.setSource=function(t){this.source=t.source,this.dimensions=t.dimensions,this.dimension.row=t.dimensions[0],this.dimension.col=t.dimensions[1],this.dimension.value=t.dimensions[2],this.dimension.info=t.dimensions[3];var e=[],i=[];this.userDef={};var n=this;o.each(this.source,function(t,o){e.push(t[n.dimension.col]),i.push(t[n.dimension.row])}),this.rowArray=o.uniq(i),this.colArray=o.uniq(e),this.userDef.col=this.colArray.length,this.userDef.row=this.rowArray.length},t.exports=r}(t)}).call(this,i(10)(t),i(18),i(16))},608:function(t,e,i){(function(t,e,o){
/*!***********************************************
Copyright (c) 2014, Neusoft Inc.
All rights reserved.
SaCa DataViz Version 2.0.0
************************************************/
!function(t){var n=i(531),a=i(561),s=i(563);function r(t,i,o){if(!t[i])return 0;var n=e.reduce(t,function(t,e){return t+(isNaN(e)?0:e)},0);if(0===n)return 0;for(var a=Math.pow(10,o),s=e.map(t,function(t){return(isNaN(t)?0:t)/n*a*100}),r=100*a,h=e.map(s,function(t){return Math.floor(t)}),l=e.reduce(h,function(t,e){return t+e},0),u=e.map(s,function(t,e){return t-h[e]});l<r;){for(var d=Number.NEGATIVE_INFINITY,c=null,f=0,m=u.length;f<m;++f)u[f]>d&&(d=u[f],c=f);++h[c],u[c]=0,++l}return h[i]/a}var h=n.extend(n.Chart,{initialize:function(t,e){this.type="DoubleLineChart",this.node=this.checkContainer(t),this.defaults.width=1e3,this.defaults.height=600,this.defaults.coloumName=[],this.defaults.textStyle={"font-family":"Microsoft Yahei","font-size":"12px","font-weight":"normal"},this.defaults.headerStyle={"font-family":"Microsoft Yahei",fill:"grey","font-size":1.2*parseInt(this.defaults.textStyle["font-size"])+"px"},this.defaults.captionStyle={"font-family":"Microsoft Yahei",fill:"black","font-size":1.4*parseInt(this.defaults.textStyle["font-size"])+"px"},this.defaults.focusStyle={"font-size":1.2*parseInt(this.defaults.textStyle["font-size"])+"px","font-weight":"bold"},this.defaults.singleLeft=void 0,this.defaults.onMouseOver=function(t){},this.defaults.onMouseOut=function(t){},this.defaults.onSpecialColor=void 0,e.adaption&&this.textAdaption(),this.setOptions(e),this.source,this._init(),this.dimension={}}});h.prototype.textAdaption=function(){var t=this.defaults;this.originFonts={},this.originWidth=t.width,this.originHeight=t.height,this.originFonts.textStyle={},this.originFonts.headerStyle={},this.originFonts.captionStyle={},this.originFonts.focusStyle={},this.originFonts.textStyle["font-size"]=parseFloat(t.textStyle["font-size"]),this.originFonts.headerStyle["font-size"]=parseFloat(t.headerStyle["font-size"]),this.originFonts.captionStyle["font-size"]=parseFloat(t.captionStyle["font-size"]),this.originFonts.focusStyle["font-size"]=parseFloat(t.focusStyle["font-size"]);var e=parseFloat(o(this.node).width()),i=parseFloat(o(this.node).height()),n=e/this.originWidth<i/this.originHeight?e/this.originWidth:i/this.originHeight;t.textStyle["font-size"]=parseInt(this.originFonts.textStyle["font-size"]),t.headerStyle["font-size"]=parseInt(this.originFonts.headerStyle["font-size"]),t.captionStyle["font-size"]=parseInt(this.originFonts.captionStyle["font-size"]),t.focusStyle["font-size"]=parseInt(this.originFonts.focusStyle["font-size"]),t.textStyle["font-size"]*=n,t.headerStyle["font-size"]*=n,t.captionStyle["font-size"]*=n,t.focusStyle["font-size"]*=n,isNaN(t.textStyle["font-size"])&&(t.textStyle["font-size"]=this.originFonts.textStyle["font-size"]),isNaN(t.headerStyle["font-size"])&&(t.headerStyle["font-size"]=this.originFonts.headerStyle["font-size"]),isNaN(t.captionStyle["font-size"])&&(t.captionStyle["font-size"]=this.originFonts.captionStyle["font-size"]),isNaN(t.focusStyle["font-size"])&&(t.focusStyle["font-size"]=this.originFonts.focusStyle["font-size"])},h.prototype._setColor=function(){var t=this.owner.theme;this.owner.colorArray=0==this.owner.colorArray.length?s.getThemeColor(t):this.owner.colorArray},h.prototype._getColor=function(t){var e=this.defaults,i=t[this.dimension.leftBar];return s.getSpecialColor(e.onSpecialColor,t)||s.getColor(i,this.owner.colorDict,this.owner.colorArray)},h.prototype._init=function(){var t=this;t.number=1,this.on("mouseover",function(i){t.overFlag=t.number++;var o=-1,n=i[0];e.each(this.source[0].data.keys[0],function(t,e){if(t==i[1])return o=e,!1});var s=o;t.leftSet.hide(),t.source.forEach(function(e,i){var o={keys:[],data:[]};o.keys=e.data.keys.map(function(t){return t}),o.data[n]=e.data.data[n].map(function(t){return t}),o.data[1-n]=e.data.data[1-n].map(function(t){return t.map(function(t,e){return s==e?t:0})}),newData=t.visualize(o);for(var h=0,l=newData.subBars[1].length;h<l;h++)if(newData.subBars[1][h].key1==s){var u=Math.round(t.canvas.width/6+i*t.canvas.width/2),d=Math.round(11*t.canvas.width/36+i*t.canvas.width/2),c=Math.round(newData.edges[h].y1),f=Math.round(newData.edges[h].y2),m=Math.round(newData.edges[h].h1),p=Math.round(newData.edges[h].h2),g=newData.edges[h].key1,v=t.canvas.path("M"+u+","+c+"L"+u+","+(c+m)+"L"+d+","+(f+p)+"L"+d+","+f).attr({fill:t.colorSetM[g],stroke:"none","stroke-width":2,opacity:"0"}).animate({opacity:"0.5"},800),y=newData.subBars[1][h].key2,x=11*t.canvas.width/36+i*t.canvas.width/2,w=newData.subBars[1][h].y,b=newData.subBars[1][h].height,k=t.canvas.rect(x,w,t.canvas.width/30*.8,b).attr({fill:t.colorSetM[s],stroke:"none"}),S=newData.subBars[1][y].y+newData.subBars[1][h].height/2;text2_x=17*t.canvas.width/48+i*t.canvas.width/2+t.canvas.width/180;var C=t.canvas.text(text2_x,S,newData.keys[1][y]).attr(t.defaults.textStyle),M=e.data.data[0][s],D=25*t.canvas.width/268+i*t.canvas.width/2+t.canvas.width/3,T=t.canvas.text(D,S,M[y].toFixed(0)).attr(t.defaults.textStyle),I=a.d3.sum(e.data.data[0][s]),z=33*t.canvas.width/268+i*t.canvas.width/2+t.canvas.width/3,O=t.canvas.text(z,S,0==I?0:" ("+r(M,y,0)+"%)").attr(t.defaults.textStyle);t.subRedrawSet.push(k,v,C,T,O)}}),t.subRedrawSet.transform("t0,"+t.defaults.width/15)}),this.on("mouseout",function(e){t.leftSet.show(),t.subRedrawSet.remove()}),this.on("mouseoverS",function(i){var o=i[0],n=-1;e.each(this.source[0].data.keys[1],function(t,e){if(t==i[1])return n=e,!1});var s=n;t.subOverFlag=t.number++,t.rightSet.hide(),t.source.forEach(function(e,i){var n={keys:[],data:[]};n.keys=e.data.keys.map(function(t){return t}),n.data[o]=e.data.data[o].map(function(t){return t}),n.data[1-o]=e.data.data[1-o].map(function(t){return t.map(function(t,e){return s==e?t:0})}),newData=t.visualize(n);for(var h=0;h<newData.subBars[0].length;h++)if(newData.subBars[1][h].key2==s){var l=Math.round(t.canvas.width/6+i*t.canvas.width/2),u=Math.round(11*t.canvas.width/36+i*t.canvas.width/2),d=Math.round(newData.edges[h].y1),c=Math.round(newData.edges[h].y2),f=Math.round(newData.edges[h].h1),m=Math.round(newData.edges[h].h2),p=newData.edges[h].key1,g=t.canvas.path("M"+l+","+d+"L"+l+","+(d+f)+"L"+u+","+(c+m)+"L"+u+","+c).attr({fill:t.colorSetM[p],stroke:"none","stroke-width":2,opacity:"0.0"}).animate({opacity:"0.5"},800),v=5*t.canvas.width/36+i*t.canvas.width/2,y=newData.subBars[1][h].key1;elem2=t.canvas.rect(v,d,t.canvas.width/30*.8,f).attr({fill:0==newData.mainBars[0][y].value?"white":t.colorSetM[y],stroke:"none"});var x=newData.subBars[1][h].key1,w=d+f/2,b=6*t.canvas.width/180+i*t.canvas.width/2,k=t.canvas.text(b,w,newData.keys[0][x]).attr(t.defaults.textStyle),S=e.data.data[1][s],C=22*t.canvas.width/268+i*t.canvas.width/2,M=t.canvas.text(C,w,S[x].toFixed(0)).attr(t.defaults.textStyle),D=a.d3.sum(e.data.data[1][s]),T=33*t.canvas.width/268+i*t.canvas.width/2,I=t.canvas.text(T,w,0==D?0:" ("+r(S,x,0)+"%)").attr(t.defaults.textStyle);t.mainRedrawSet.push(g,elem2,k,M,I)}}),t.mainRedrawSet.transform("t0,"+t.defaults.width/15)}),this.on("mouseoutS",function(e){t.mainRedrawSet.remove(),t.rightSet.show()})},h.prototype.setSource=function(t){this.dimensions=t.dimensions,this.dimensionType=t.dimensionType,this.dimensionDomain=t.dimensionDomain,this.dimension.leftBar=t.dimensions[0],this.dimension.rightBar=t.dimensions[1],this.dimension.value1=t.dimensions[2],this.dimension.value2=t.dimensions[3];var i=this.defaults;that=this;var o,n,s=[],r=a.tablify(t.source).slice(1);this.header=a.tablify(t.source).slice(0,1)[0],e.each(this.header,function(t,e){t===that.dimension.leftBar&&(o=e),t===that.dimension.rightBar&&(n=e)}),i.coloumName=o<n?0==i.coloumName.length?[this.dimension.leftBar,"",this.dimension.rightBar,""]:i.coloumName:0==i.coloumName.length?[this.dimension.rightBar,"",this.dimension.leftBar,""]:i.coloumName;var h={};h.keys=[a.d3.set(r.map(function(t){return t[0]})).values().sort(function(t,e){return t<e?-1:t>e?1:0}),a.d3.set(r.map(function(t){return t[1]})).values().sort(function(t,e){return t<e?-1:t>e?1:0})],h.data=[h.keys[0].map(function(t){return h.keys[1].map(function(t){return 0})}),h.keys[1].map(function(t){return h.keys[0].map(function(t){return 0})})],r.forEach(function(t){h.data[0][e.indexOf(h.keys[0],t[0])][e.indexOf(h.keys[1],t[1])]=t[2],h.data[1][e.indexOf(h.keys[1],t[1])][e.indexOf(h.keys[0],t[0])]=t[2]}),s.push(h);var l={};l.keys=[a.d3.set(r.map(function(t){return t[0]})).values().sort(function(t,e){return t<e?-1:t>e?1:0}),a.d3.set(r.map(function(t){return t[1]})).values().sort(function(t,e){return t<e?-1:t>e?1:0})],l.data=[l.keys[0].map(function(t){return l.keys[1].map(function(t){return 0})}),l.keys[1].map(function(t){return l.keys[0].map(function(t){return 0})})],r.forEach(function(t){l.data[0][e.indexOf(l.keys[0],t[0])][e.indexOf(l.keys[1],t[1])]=t[3],l.data[1][e.indexOf(l.keys[1],t[1])][e.indexOf(l.keys[0],t[0])]=t[3]}),this.defaults.singleLeft?this.source=[{data:s[0],id:this.dimension.value1,header:[i.coloumName[0],i.coloumName[1],i.coloumName[2],i.coloumName[3],this.dimension.value1]}]:(s.push(l),this.source=[{data:s[0],id:this.dimension.value1,header:[i.coloumName[0],i.coloumName[1],i.coloumName[2],i.coloumName[3],this.dimension.value1]},{data:s[1],id:this.dimension.value2,header:[i.coloumName[0],i.coloumName[1],i.coloumName[2],i.coloumName[3],this.dimension.value2]}])},h.prototype.visualize=function(t){var e=.85*this.defaults.height,i=.023*this.defaults.height,o={};function n(t,e,i,o,n){var s=a.d3.sum(t),r=0,h=i-e-2*o*t.length,l=[];t.forEach(function(a){var u={};u.percent=0==s?0:a/s,u.value=a,u.height=Math.max(u.percent*(i-e-2*o*t.length),n),u.height==n?h-=n:r+=u.height,l.push(u)});var u=h/Math.max(r,1),d=0;return l.forEach(function(a){a.percent=u*a.percent,a.height=a.height==n?n:a.height*u,a.middle=d+o+a.height/2,a.y=e+a.middle-a.percent*(i-e-2*o*t.length)/2,a.h=a.percent*(i-e-2*o*t.length),a.percent=0==s?0:a.value/s,d+=2*o+a.height}),l}return o.mainBars=[n(t.data[0].map(function(t){return a.d3.sum(t)}),0,e,0,i),n(t.data[1].map(function(t){return a.d3.sum(t)}),0,e,0,i)],o.subBars=[[],[]],o.mainBars.forEach(function(e,i){e.forEach(function(e,a){n(t.data[i][a],e.y,e.y+e.h,0,0).forEach(function(t,e){t.key1=0==i?a:e,t.key2=0==i?e:a,o.subBars[i].push(t)})})}),o.subBars.forEach(function(t){t.sort(function(t,e){return t.key1<e.key1?-1:t.key1>e.key1?1:t.key2<e.key2?-1:t.key2>e.key2?1:0})}),o.edges=o.subBars[0].map(function(t,e){return{key1:t.key1,key2:t.key2,y1:t.y,y2:o.subBars[1][e].y,h1:t.h,h2:o.subBars[1][e].h}}),o.keys=t.keys,o},h.prototype.drawPart=function(t,e,i){var o=this;this.colorSetM=[],this.colorSetS=[];var n=o.source[i].data.data[0].map(function(t){return a.d3.sum(t)}),s=o.source[i].data.data[1].map(function(t){return a.d3.sum(t)}),h=a.d3.sum(n),l=a.d3.sum(s),u=null;o.defaults.singleLeft&&(o.canvas.width=2*o.canvas.width);for(var d=0;d<t.mainBars[0].length;d++){var c=o.canvas.set(),f=5*o.canvas.width/36+i*o.canvas.width/2,m=t.mainBars[0][d].middle-t.mainBars[0][d].height/2,p=t.mainBars[0][d].height;(z={})[o.dimension.leftBar]=t.keys[0][d],z.flag="left";var g=o._getColor(z);o.colorSetM.push(g);var v=t.mainBars[0][d].value,y=this.canvas.rect(f,m,o.canvas.width/36,p).attr({fill:0==v?"white":g,stroke:"none"}).data("obj",z).data("i",d).mouseover(function(e){this.attr("stroke","black"),o.defaults.onMouseOver(e,this.data("obj")),o.fire("mouseover",[0,t.keys[0][this.data("i")]])}).mouseout(function(e){this.attr("stroke","none"),o.fire("mouseout",[0,t.keys[0][this.data("i")]]),o.defaults.onMouseOut(e,this.data("obj"))}).touchstart(function(e){clearTimeout(u);var i=[0,t.keys[0][this.data("i")]],n=this;this.attr("stroke","black"),o.fire("mouseover",i),o.defaults.onMouseOver(e,this.data("obj")),u=setTimeout(function(){n.attr("stroke","none"),o.fire("mouseout",i),o.defaults.onMouseOut(e,n.data("obj")),clearTimeout(u)},3e3)}),x=t.mainBars[0][d].middle,w=6*o.canvas.width/180+i*o.canvas.width/2,b=this.canvas.text(w,x,t.keys[0][d]),k=22*o.canvas.width/268+i*o.canvas.width/2,S=this.canvas.text(k,x,n[d].toFixed(0)),C=33*o.canvas.width/268+i*o.canvas.width/2,M=this.canvas.text(C,x,0==h?0:" ("+r(n,d,0)+"%)");c.push(b,S,M).data("i",d).data("obj",z).attr(o.defaults.textStyle).mouseover(function(e){this.attr(o.defaults.focusStyle),o.fire("mouseover",[0,t.keys[0][this.data("i")]]),o.defaults.onMouseOver(e,this.data("obj"))}).mouseout(function(e){this.attr(o.defaults.textStyle),o.fire("mouseout",[0,t.keys[0][this.data("i")]]),o.defaults.onMouseOut(e,this.data("obj"))}).touchstart(function(e){clearTimeout(u);var i=[0,t.keys[0][this.data("i")]],n=this;this.attr(o.defaults.focusStyle),o.fire("mouseover",i),o.defaults.onMouseOver(e,this.data("obj")),u=setTimeout(function(){n.attr(o.defaults.textStyle),o.fire("mouseout",i),o.defaults.onMouseOut(e,n.data("obj")),clearTimeout(u)},3e3)}),o.rightSet.push(y,b,S,M),o.raphealSet.push(y,b,S,M)}for(d=0;d<t.subBars[1].length;d++){var D=11*o.canvas.width/36+i*o.canvas.width/2,T=t.subBars[1][d].y,I=(p=t.subBars[1][d].height,t.subBars[1][d].key1);y=this.canvas.rect(D,T,o.canvas.width/30*.8,p).attr({fill:o.colorSetM[I],stroke:"none"});o.leftSet.push(y),o.raphealSet.push(y)}for(d=0;d<t.mainBars[1].length;d++){var z;D=11*o.canvas.width/36+i*o.canvas.width/2,T=t.mainBars[1][d].middle-t.mainBars[1][d].height/2,p=t.mainBars[1][d].height;(z={})[o.dimension.rightBar]=t.keys[1][d],z.flag="right";g=o._getColor(z);var O=o.canvas.set();y=this.canvas.rect(D,T,o.canvas.width/30*.8,p).attr({fill:g,stroke:"none","fill-opacity":"0.0"}).data("i",d).data("obj",z).mouseover(function(e){this.attr("stroke","black"),o.fire("mouseoverS",[1,t.keys[1][this.data("i")]]),o.defaults.onMouseOver(e,this.data("obj"))}).mouseout(function(e){this.attr("stroke","none"),o.fire("mouseoutS",[1,t.keys[1][this.data("i")]]),o.defaults.onMouseOut(e,this.data("obj"))}).touchstart(function(e){clearTimeout(u);var i=[1,t.keys[1][this.data("i")]],n=this;this.attr("stroke","black"),o.fire("mouseoverS",i),o.defaults.onMouseOver(e,this.data("obj")),u=setTimeout(function(){n.attr("stroke","none"),o.fire("mouseoutS",i),o.defaults.onMouseOut(e,n.data("obj")),clearTimeout(u)},3e3)}),x=t.mainBars[1][d].middle;text2_x=17*o.canvas.width/48+i*o.canvas.width/2+o.canvas.width/180;var B=this.canvas.text(text2_x,x,t.keys[1][d]),j=22*o.canvas.width/268+i*o.canvas.width/2+o.canvas.width/3,N=this.canvas.text(j,x,s[d].toFixed(0)),_=33*o.canvas.width/268+i*o.canvas.width/2+o.canvas.width/3,R=this.canvas.text(_,x,0==l?0:" ("+r(s,d,0)+"%)");O.push(B,N,R),O.data("i",d).data("obj",z).attr(o.defaults.textStyle).mouseover(function(e){this.attr(o.defaults.focusStyle),o.fire("mouseoverS",[1,t.keys[1][this.data("i")]]),o.defaults.onMouseOver(e,this.data("obj"))}).mouseout(function(e){this.attr(o.defaults.textStyle),o.fire("mouseoutS",[1,t.keys[1][this.data("i")]]),o.defaults.onMouseOut(e,this.data("obj"))}).touchstart(function(e){u&&clearTimeout(u);var i=[1,t.keys[1][this.data("i")]],n=this;this.attr(o.defaults.focusStyle),o.fire("mouseoverS",i),o.defaults.onMouseOver(e,this.data("obj")),u=setTimeout(function(){n.attr(o.defaults.textStyle),o.fire("mouseoutS",i),o.defaults.onMouseOut(e,n.data("obj")),u&&clearTimeout(u)},3e3)}),o.leftSet.push(y,B,N,R),o.raphealSet.push(y,B,N,R)}},h.prototype.drawEdges=function(t,e,i){for(var o=0;o<t.subBars[0].length;o++){var n=Math.round(this.canvas.width/6+i*this.canvas.width/2),a=Math.round(11*this.canvas.width/36+i*this.canvas.width/2),s=Math.round(t.edges[o].y1),r=Math.round(t.edges[o].y2),h=Math.round(t.edges[o].h1),l=Math.round(t.edges[o].h2),u=t.edges[o].key1,d=this.canvas.path("M"+n+","+s+"L"+n+","+(s+h)+"L"+a+","+(r+l)+"L"+a+","+r).attr({fill:this.colorSetM[u],stroke:"none","stroke-width":2,opacity:".5"});this.rightSet.push(d),this.leftSet.push(d),this.raphealSet.push(d)}this.raphealSet.transform("t0,"+this.defaults.width/15)},h.prototype.drawHeader=function(t,e,i){var o=this.canvas.set(),n=t.mainBars[0][0].y-this.canvas.width/80,a=6*this.canvas.width/180+i*this.canvas.width/2,s=this.canvas.text(a,n,this.source[i].header[0]).attr(this.defaults.headerStyle),r=5*this.canvas.width/48+i*this.canvas.width/2,h=this.canvas.text(r,n,this.source[i].header[1]).attr(this.defaults.headerStyle),l=17*this.canvas.width/48+i*this.canvas.width/2+this.canvas.width/180,u=this.canvas.text(l,n,this.source[i].header[2]).attr(this.defaults.headerStyle),d=5*this.canvas.width/48+i*this.canvas.width/2+this.canvas.width/3,c=this.canvas.text(d,n,this.source[i].header[3]).attr(this.defaults.headerStyle),f=t.mainBars[0][0].y-.9*t.mainBars[0][0].y,m=i*this.canvas.width/2,p=5*this.canvas.width/36+i*this.canvas.width/2,g=this.canvas.path("M"+m+","+f+"H"+p).attr("stroke-width","0.8px").attr("stroke",this.defaults.headerStyle.fill),v=this.canvas.width/3+i*this.canvas.width/2,y=4*this.canvas.width/9+i*this.canvas.width/2+this.canvas.width/36,x=this.canvas.path("M"+v+","+f+"H"+y).attr("stroke-width","0.8px").attr("stroke",this.defaults.headerStyle.fill),w=17*this.canvas.width/72+i*this.canvas.width/2;this.canvas.text(w,this.defaults.height/50,this.source[i].header[4]).attr(this.defaults.captionStyle),o.push(h,u,c,s,g,x),o.transform("t0,"+this.defaults.width/15)},h.prototype._layout=function(){for(var t=0;t<this.source.length;t++){var e=this.source[t].id,i=this.source[t].data,o=this.visualize(i);this.drawPart(o,e,t),this.drawEdges(o,e,t),this.drawHeader(o,i.id,t)}},h.prototype.selectSegment=function(t,e,i){t.forEach(function(t){var o={keys:[],data:[]};o.keys=t.data.keys.map(function(t){return t}),o.data[e]=t.data.data[e].map(function(t){return t}),o.data[1-e]=t.data.data[1-e].map(function(t){return t.map(function(t,e){return i==e?t:0})})})},h.prototype.render=function(){this._setColor(),this.canvas&&(this.raphealSet=this.canvas.set(),this.leftSet=this.canvas.set(),this.rightSet=this.canvas.set(),this.subRedrawSet=this.canvas.set(),this.mainRedrawSet=this.canvas.set(),this._layout())},h.prototype.mousedblclick=function(t,e,i){this.defaults.onDblClick&&this.defaults.onDblClick(t,e,i)},t.exports=h}(t)}).call(this,i(10)(t),i(16),i(18))},609:function(t,e,i){(function(t,e,o){
/*!***********************************************
Copyright (c) 2014, Neusoft Inc.
All rights reserved.
SaCa DataViz Version 2.0.0
************************************************/
!function(t){var n=i(531),a=i(561),s=i(563),h=n.extend(n.Chart,{initialize:function(t,e){this.type="DotChart",this.node=this.checkContainer(t),this.defaults.width=800,this.defaults.height=400,this.defaults.padding={top:120,bottom:20,left:80,right:40},this.defaults.userDef=void 0,this.defaults.colorMode="default",this.defaults.userColor=["red","green","blue","orange","black"],this.defaults.rowLabelStyle={"font-size":"12px"},this.defaults.colLabelStyle={"font-size":"12px"},this.defaults.circleFontStyle={font:"12px Fontin-Sans, Arial",stroke:"none",fill:"#000"},this.defaults.colRotate=40,this.defaults.showGradient=!0,this.defaults.onSpecialColor=void 0,this.defaults.onClick=function(t){},this.defaults.onMouseOver=function(t){},this.defaults.onTouchStart=function(t){},this.defaults.onTouchEnd=function(t){},this.defaults.onMouseOut=function(t){},e.adaption&&this.textAdaption(),this.setOptions(e),this.textArray,this.dataArray,this.tickCount,this.dataNum,this.labelColor=[],this.ori_source,this.source,this.dimension={}}});h.prototype.textAdaption=function(){var t=this.defaults;this.originFonts={},this.originWidth=t.width,this.originHeight=t.height,this.originFonts.rowLabelStyle={},this.originFonts.colLabelStyle={},this.originFonts.rowLabelStyle["font-size"]=parseFloat(t.rowLabelStyle["font-size"]),this.originFonts.colLabelStyle["font-size"]=parseFloat(t.colLabelStyle["font-size"]);var i=parseFloat(e(this.node).width()),o=parseFloat(e(this.node).height()),n=i/this.originWidth<o/this.originHeight?i/this.originWidth:o/this.originHeight;t.rowLabelStyle["font-size"]=parseInt(this.originFonts.rowLabelStyle["font-size"]),t.colLabelStyle["font-size"]=parseInt(this.originFonts.colLabelStyle["font-size"]),t.rowLabelStyle["font-size"]*=n,t.colLabelStyle["font-size"]*=n,isNaN(t.rowLabelStyle["font-size"])&&(t.rowLabelStyle["font-size"]=this.originFonts.rowLabelStyle["font-size"]),isNaN(t.colLabelStyle["font-size"])&&(t.colLabelStyle["font-size"]=this.originFonts.colLabelStyle["font-size"]);for(var a=t.circleFontStyle.font.split(" "),s=0;s<a.length;s++)if(a[s].indexOf("px")>-1){var r=parseFloat(a[s]);r*=n,a[s]=r+"px";break}t.circleFontStyle.font=a.join(" ")},h.prototype._setColor=function(){var t=this.owner.theme;this.owner.colorArray=0==this.owner.colorArray.length?s.getThemeColor(t):this.owner.colorArray},h.prototype._getColor=function(t,e){if("custom"==this.defaults.colorMode)return color=this.defaults.userColor,t=(t-1)%color.length,color[t];var i=this.defaults,o=this.dimension.c,n=e[o];return this.owner.legendData&&this.owner.legendData!=this.dimension.c?(n=e[o=this.owner.legendData],s.getColor(n,this.owner.colorDict,this.owner.colorArray)):s.getSpecialColor(i.onSpecialColor,e)||s.getColor(n,this.owner.colorDict,this.owner.colorArray)},h.prototype._axisXY=function(t,e,i,o,n,a,s,r){var h=s.canvas;if("x"===r){if(t>i||e!=o)throw new Error("DataViz Error # Coordinate Error : Invalid input");b=10,textMargin=15;for(var l=0;l<tickCount;l++){yPath="M"+a[l]+","+e+"L"+a[l]+","+(e-b),h.path(yPath).attr({stroke:s.defaults.labelTickFill,"stroke-width":"0.5px"}),text=n[l];var u=h.text(a[l],e-textMargin-b,text).attr(s.defaults.colLabelStyle);s.defaults.colRotate&&(box=u.getBBox(!0),rx=box.x2-box.width,ry=box.y2,u.transform("t"+box.width/2+",0r-"+s.defaults.colRotate+" "+rx+","+ry)),u.data("num",l),u.data("text",text),s.colNode.push(u)}var d="M"+a[0]+","+e+" L"+a[a.length-1]+","+o;h.path(d).attr({stroke:s.defaults.labelTickLineFill,"stroke-width":"0.5px"})}},h.prototype._paintBubble=function(t,e,i,n,a,s,h,l){canvas=t.canvas;var u=t.defaults,d=o.clone(t.defaults.rowLabelStyle);d["font-size"]=d["font-size"]?parseInt(d["font-size"]):11,d["font-size"]=d["font-size"],num=0,classNum=1,max=this.dimensionDomain[this.dimension.value][1],min=this.dimensionDomain[this.dimension.value][0];var c=function(t,e,i){var o;return o=0==t?0:(h.radius-h["min-radius"])/(e-i)*t+h["min-radius"],parseFloat(o)},f=(t=this,10);if(e>10&&(f=e),l){var m=t.ori_source,p=o.groupBy(m,function(e){return e[t.dimension.row]}),g=[];for(var v in p)g.push(p[v]);m=g.sort(function(e,i){var n=o.find(e,function(e){return e[t.dimension.col]==l})[t.dimension.value];return o.find(i,function(e){return e[t.dimension.col]==l})[t.dimension.value]-n});for(var y=0;y<m.length;y++){var x=m[y][0][t.dimension.row];x.length>=12&&(x=x.slice(0,12)+"...");for(var w=0;w<m[y].length;w++){data=m[y][w][t.dimension.value],r=10*c(data,max,min)/f,r<0&&(r=0);var b=canvas.circle(i[w],n[num],0).attr({stroke:"none",fill:labelColor[x]}).animate({r:r},300),k=canvas.text(i[w],n[num],data).attr(t.defaults.circleFontStyle).hide();b.data(t.dimension.value,data),b.data(t.dimension.col,m[y][w][t.dimension.col]),b.data(t.dimension.row,m[y][w][t.dimension.row]),b.data(t.dimension.info,m[y][w][t.dimension.info]),b.data(t.dimension.c,m[y][w][t.dimension.c]),this.circleNode.push(b),this.dataNode.push(k)}(M=canvas.text(0,n[num],x).attr({"font-size":"10px","text-anchor":"start"}).attr(d)).data(t.dimension.c,m[y][0][t.dimension.c]),M.data(t.dimension.row,m[y][0][t.dimension.row]),M.data("num",num),M.data("text",x),this.labelNode.push(M),num+=1}}else for(var S in m=t.source)if(m.hasOwnProperty(S)){pathNum=1;p=o.groupBy(m[S],function(e){return e[t.dimension.row]});for(var v in p){u.showGradient?(opacity=1-.1*pathNum,opacity<=.3&&(opacity=.3)):opacity=1;for(w=0;w<p[v].length;w++){data=p[v][w][this.dimension.value],r=10*c(data,max,min)/f,r<0&&(r=0),(C={})[this.dimension.value]=data,C[this.dimension.col]=p[v][w][this.dimension.col],C[this.dimension.row]=p[v][w][this.dimension.row],C[this.dimension.info]=p[v][w][this.dimension.info],C[this.dimension.c]=p[v][w][this.dimension.c];b=canvas.circle(i[w],n[num],r).attr({stroke:"none",fill:t._getColor(classNum,C),"fill-opacity":opacity}),k=canvas.text(i[w],n[num],data).attr(t.defaults.circleFontStyle).hide();b.data(this.dimension.value,C[this.dimension.value]),b.data(this.dimension.col,C[this.dimension.col]),b.data(this.dimension.row,C[this.dimension.row]),b.data("opacity",opacity),b.data(this.dimension.info,C[this.dimension.info]),b.data(t.dimension.c,C[this.dimension.c]),this.circleNode.push(b),this.dataNode.push(k)}var C,M;(x=p[v][0][this.dimension.row]).length>=12&&(x=x.slice(0,12)+"..."),(C={})[this.dimension.row]=p[v][0][this.dimension.row],C[this.dimension.info]=p[v][0][this.dimension.info],C[this.dimension.c]=p[v][0][this.dimension.c],labelColor[x]=t._getColor(classNum,C),(M=canvas.text(0,n[num],x).attr({"fill-opacity":opacity,"font-size":"10px","text-anchor":"start"}).attr(d)).data(t.dimension.c,C[this.dimension.c]),M.data(t.dimension.row,C[this.dimension.row]),M.data("num",num),M.data("text",x),this.labelNode.push(M),num+=1,pathNum+=1}classNum+=1}},h.prototype._layout=function(t){this._setColor();var e=this.defaults.width,i=this.defaults.height,o=this.defaults.padding,a=this.defaults.userDef,s=this.dataArray,r=this.dataNum,h=this.floatTag,l=this.textArray,u=this,d=null,c=0;tickCount=this.tickCount,labelColor=this.labelColor,this.labelNode=[],this.colNode=[],this.circleNode=[],this.dataNode=[];for(var f=o.left,m=o.top,p=e,g=m,v=function(t,e,i){for(var o=[],n=parseFloat(1*(e-t)/i),a=0;a<=i-1;a++)o.push(t+a*n);return o}(f,p,tickCount),y=0,x=v.length;y<x;y++)v[y]=v[y]+o.right/x;var w=function(t,e,i){for(var o=[],n=parseFloat(1*(e-t)/i),a=1;a<=i;a++)o.push(t+a*n);return o}(m,i-o.bottom,r);u._axisXY(f,m,p,g,l,v,u,"x"),u._paintBubble(u,tickCount,v,w,s,l,a,t);for(y=0;y<this.circleNode.length;y++)this.circleNode[y].mouseover(function(t){if(!n.isMobile){this.attr("cursor","pointer");var e={};e[u.dimension.row]=this.data(u.dimension.row),e[u.dimension.col]=this.data(u.dimension.col),e[u.dimension.value]=this.data(u.dimension.value),e[u.dimension.c]=this.data(u.dimension.c),e[u.dimension.info]=this.data(u.dimension.info),h&&h.show(e),this.animate({"fill-opacity":1},150),u.fire("hoverIn",this.data(u.dimension.c)),u.defaults.onMouseOver(t,e)}}).mouseout(function(t){if(!n.isMobile){h&&h.hide(),this.data("opacity")&&this.animate({"fill-opacity":this.data("opacity")},150),u.fire("hoverOut",this.data(u.dimension.c));var e={};e[u.dimension.row]=this.data(u.dimension.row),e[u.dimension.col]=this.data(u.dimension.col),e[u.dimension.value]=this.data(u.dimension.value),e[u.dimension.c]=this.data(u.dimension.c),e[u.dimension.info]=this.data(u.dimension.info),u.defaults.onMouseOut(t,e)}}).click(function(t){if(n.isMobile)return null;var e={};e[u.dimension.row]=this.data(u.dimension.row),e[u.dimension.col]=this.data(u.dimension.col),e[u.dimension.value]=this.data(u.dimension.value),e[u.dimension.c]=this.data(u.dimension.c),e[u.dimension.info]=this.data(u.dimension.info),u.defaults.onClick(t,e)}).mouseup(function(t){if(n.isMobile)return null;var e={};e[u.dimension.row]=this.data(u.dimension.row),e[u.dimension.col]=this.data(u.dimension.col),e[u.dimension.value]=this.data(u.dimension.value),e[u.dimension.c]=this.data(u.dimension.c),e[u.dimension.info]=this.data(u.dimension.info),u.defaults.onMouseUp(t,e)}).touchstart(function(t){var e={};if(e[u.dimension.row]=this.data(u.dimension.row),e[u.dimension.col]=this.data(u.dimension.col),e[u.dimension.value]=this.data(u.dimension.value),e[u.dimension.c]=this.data(u.dimension.c),e[u.dimension.info]=this.data(u.dimension.info),c=new Date,n.isMobile){d&&clearTimeout(d),this.attr("cursor","pointer"),h&&h.show(e),this.animate({"fill-opacity":1},150);var i=this;d=setTimeout(function(){h&&h.hide(),i.data("opacity")&&i.animate({"fill-opacity":i.data("opacity")},150),d&&clearTimeout(d)},3e3)}u.defaults.onTouchStart(t,e)}).touchend(function(t){var e={};e[u.dimension.row]=this.data(u.dimension.row),e[u.dimension.col]=this.data(u.dimension.col),e[u.dimension.value]=this.data(u.dimension.value),e[u.dimension.c]=this.data(u.dimension.c),e[u.dimension.info]=this.data(u.dimension.info),new Date-c<400&&u.defaults.onClick(e),new Date-c>500||u.defaults.onTouchEnd(t,e)});for(y=0;y<this.colNode.length;y++)this.colNode[y].mouseover(function(){this.attr("cursor","pointer");for(var t=0;t<r;t++)u.circleNode[t*tickCount+this.data("num")].hide(),u.dataNode[t*tickCount+this.data("num")].show()}).mouseout(function(){for(var t=0;t<r;t++)u.dataNode[t*tickCount+this.data("num")].hide(),u.circleNode[t*tickCount+this.data("num")].show()}).click(function(t){if(n.isMobile)return null;u.canvas.clear();var e=this.data("text");u._layout(e)}).touchstart(function(t){u.canvas.clear();var e=this.data("text");u._layout(e)}).touchend(function(t){u.canvas.clear();var e=this.data("text");u._layout(e)});for(y=0;y<this.labelNode.length;y++)this.labelNode[y].mouseover(function(t){this.attr("cursor","pointer");for(var e=0;e<tickCount;e++)u.circleNode[this.data("num")*tickCount+e].hide(),u.dataNode[this.data("num")*tickCount+e].show()}).mouseout(function(t){for(var e=0;e<tickCount;e++)u.dataNode[this.data("num")*tickCount+e].hide(),u.circleNode[this.data("num")*tickCount+e].show()})},h.prototype.mouseclick=function(t,e){for(var i=0;i<this.circleNode.length;i++){var o=this.circleNode[i].data(this.dimension.row),n=this.circleNode[i].data(this.dimension.col);if(o==t&&n==e){var a={row:this.circleNode[i].data(this.dimension.row),col:this.circleNode[i].data(this.dimension.col),value:this.circleNode[i].data(this.dimension.value),c:this.circleNode[i].data(this.dimension.c),info:this.circleNode[i].data(this.dimension.info)};this.defaults.onClick&&this.defaults.onClick(a)}}},h.prototype.legendMouseover=function(t){for(var e=0;e<this.labelNode.length;e++){var i=this.labelNode[e].data(this.dimension.c);if(this.owner.legendData&&(i=this.labelNode[e].data(this.owner.legendData)),i==t.text||i==t)for(var o=0;o<this.tickCount;o++)this.circleNode[this.labelNode[e].data("num")*tickCount+o].hide(),this.dataNode[this.labelNode[e].data("num")*tickCount+o].show()}},h.prototype.legendMouseout=function(t){for(var e=0;e<this.labelNode.length;e++){var i=this.labelNode[e].data(this.dimension.c);if(this.owner.legendData&&(i=this.labelNode[e].data(this.owner.legendData)),i==t.text||i==t)for(var o=0;o<this.tickCount;o++)this.circleNode[this.labelNode[e].data("num")*tickCount+o].show(),this.dataNode[this.labelNode[e].data("num")*tickCount+o].hide()}},h.prototype.mousedblclick=function(t,e,i){this.defaults.onDblClick&&this.defaults.onDblClick(t,e,i)},h.prototype.rowTextMouseover=function(t){for(var e=0;e<this.labelNode.length;e++)if(this.labelNode[e].data("text")==t)for(var i=0;i<this.tickCount;i++)this.circleNode[this.labelNode[e].data("num")*tickCount+i].hide(),this.dataNode[this.labelNode[e].data("num")*tickCount+i].show()},h.prototype.rowTextMouseout=function(t){for(var e=0;e<this.labelNode.length;e++)if(this.labelNode[e].data("text")==t)for(var i=0;i<this.tickCount;i++)this.circleNode[this.labelNode[e].data("num")*tickCount+i].show(),this.dataNode[this.labelNode[e].data("num")*tickCount+i].hide()},h.prototype.colTextMouseover=function(t){for(var e=0;e<this.colNode.length;e++)if(this.colNode[e].data("text")==t)for(var i=0;i<this.dataNum;i++)this.dataNode[i*tickCount+this.colNode[e].data("num")].show(),this.circleNode[i*tickCount+this.colNode[e].data("num")].hide()},h.prototype.colTextMouseout=function(t){for(var e=0;e<this.colNode.length;e++)if(this.colNode[e].data("text")==t)for(var i=0;i<this.dataNum;i++)this.dataNode[i*tickCount+this.colNode[e].data("num")].hide(),this.circleNode[i*tickCount+this.colNode[e].data("num")].show()},h.prototype.render=function(){this._layout(null)},h.prototype.setSource=function(t){var e=t.source;this.dimensions=t.dimensions,this.dimensionType=t.dimensionType,this.dimensionDomain=t.dimensionDomain,this.dimension.row=t.dimensions[0],this.dimension.col=t.dimensions[1],this.dimension.value=t.dimensions[2],this.dimension.c=t.dimensions[3],this.dimension.info=t.dimensions[4],this.ori_source=[];var i=[],n=[],s=this;o.each(e,function(t,e){i.push(t[s.dimension.col]),n.push(t[s.dimension.row])}),this.rowArray=o.uniq(n),this.colArray=o.uniq(i);var r=[],h=o.groupBy(e,function(t){return t[s.dimension.row]});for(var l in h){var u=o.pluck(h[l],s.dimension.col);s.colArray.forEach(function(t){if(o.contains(u,t)){var e=o.filter(h[l],function(e){return e[s.dimension.col]==t})[0];r.push(e),s.ori_source.push(e)}else{var i=s.dimension.col,n=s.dimension.row,a=s.dimension.value,d=s.dimension.c,c={};c[i]=t,c[n]=l,c[a]=0,c[d]=h[l][0][d],r.push(c),s.ori_source.push(c)}})}this.defaults.userDef=this.defaults.userDef||{row:this.dimension.row,class:this.dimension.c,radius:15,"min-radius":3},this.owner.legendData&&(this.defaults.userDef.class=this.owner.legendData),userDef=this.defaults.userDef,classStr=userDef.class,this.tickCount=this.colArray.length,this.dataNum=this.rowArray.length,this.textArray=this.colArray,this.source=a.d3.nest().key(function(t){return t[classStr]}).map(r)},t.exports=h}(t)}).call(this,i(10)(t),i(18),i(16))},610:function(t,e,i){(function(t,e,o){
/*!***********************************************
Copyright (c) 2014, Neusoft Inc.
All rights reserved.
SaCa DataViz Version 2.0.0
************************************************/
!function(t){var n=i(531),a=i(561),s=i(563),r=n.extend(n.Chart,{initialize:function(t,e){this.type="ChordChart",this.node=this.checkContainer(t),this.matrix=[],this.groupNames=[],this.defaults.width=800,this.defaults.height=800,this.defaults.isSorted=!1,this.defaults.showGraduation=!1,this.defaults.showGraduationAmount=!0,this.defaults.donutTextType=1,this.defaults.textShowMode=1,this.defaults.animation=!0,this.defaults.graduation={type:"original"},this.defaults.textStyle={fill:"black","font-size":"16px","font-family":"Microsoft Yahei","text-anchor":"middle"},this.defaults.graduationTextStyle={fill:"black","font-family":"Microsoft Yahei","font-size":"12px"},this.defaults.onSpecialColor=void 0,this.defaults.onClick=function(t){},this.defaults.onMouseOver=function(t){},this.defaults.onMouseOut=function(t){},e.adaption&&this.textAdaption(),this.setOptions(e),this.xOffset=.5*this.defaults.width,this.defaults.innerRadius=.45*Math.min(.6*this.defaults.width,.6*this.defaults.height),this.defaults.outerRadius=1.1*this.defaults.innerRadius,this.dimension={}}});r.prototype.textAdaption=function(){var t=this.defaults;this.originFonts={},this.originWidth=t.width,this.originHeight=t.height,this.originFonts.textStyle={},this.originFonts.graduationTextStyle={},this.originFonts.textStyle["font-size"]=parseFloat(t.textStyle["font-size"]),this.originFonts.graduationTextStyle["font-size"]=parseFloat(t.graduationTextStyle["font-size"]);var i=parseFloat(e(this.node).width()),o=parseFloat(e(this.node).height()),n=i/this.originWidth<o/this.originHeight?i/this.originWidth:o/this.originHeight;t.textStyle["font-size"]=parseInt(this.originFonts.textStyle["font-size"]),t.graduationTextStyle["font-size"]=parseInt(this.originFonts.graduationTextStyle["font-size"]),t.textStyle["font-size"]*=n,t.graduationTextStyle["font-size"]*=n,isNaN(t.textStyle["font-size"])&&(t.textStyle["font-size"]=this.originFonts.textStyle["font-size"]),isNaN(t.graduationTextStyle["font-size"])&&(t.graduationTextStyle["font-size"]=this.originFonts.graduationTextStyle["font-size"])},r.prototype._setColor=function(){var t=this.owner.theme;this.owner.colorArray=0==this.owner.colorArray.length?s.getThemeColor(t):this.owner.colorArray},r.prototype._getColor=function(t,e){var i=this.defaults,o=t[e];return this.owner.legendData?(o=t[this.owner.legendData],s.getColor(o,this.owner.colorDict,this.owner.colorArray)):s.getSpecialColor(i.onSpecialColor,t)||s.getColor(o,this.owner.colorDict,this.owner.colorArray)},r.prototype.render=function(){this._layout()},r.prototype._groupAndSort=function(t){var e=this,i=o.groupBy(t,function(t){return t[e.dimension.from]}),n=o.sortBy(i,function(t,i){for(var o=0,n=0;n<t.length;n++)o+=t[n][e.dimension.value];return o}).reverse();t=[];for(var a=0;a<n.length;a++)t=o.union(t,n[a]);return t},r.prototype.setSource=function(t){this.source=t.source,this.dimensions=t.dimensions,this.dimensionType=t.dimensionType,this.dimensionDomain=t.dimensionDomain,this.dimension.from=t.dimensions[0],this.dimension.to=t.dimensions[1],this.dimension.value=t.dimensions[2],this.dimension.info=t.dimensions[3],1==this.defaults.isSorted&&(this.source=this._groupAndSort(this.source));var e=this,i={},o=0;e.groupNames=[],e.matrix=[],e.info=[],this.source.forEach(function(t){var n=t[e.dimension.from];void 0===i[n]&&(i[n]=o++,e.groupNames.push(n))}),this.source.forEach(function(t){var n=t[e.dimension.to];void 0===i[n]&&(i[n]=o++,e.groupNames.push(n))}),this.groupNum=o;for(var n=0;n<o;n++){this.matrix[n]=[];for(var a=0;a<o;a++)this.matrix[n][a]=0}for(n=0;n<o;n++){this.info[n]=[];for(a=0;a<o;a++)this.info[n][a]=0}this.source.forEach(function(t){e.matrix[i[t[e.dimension.from]]][i[t[e.dimension.to]]]+=Number(t[e.dimension.value]),e.info[i[t[e.dimension.from]]][i[t[e.dimension.to]]]=t[e.dimension.info]})},r.prototype.highlight=function(t,e){var i=this;this.chordGroups.forEach(function(o){var n=o.data("obj")[i.dimension.from],a=o.data("obj")[i.dimension.to];n==t&&a==e?o.attr({"fill-opacity":.6}):o.attr({"fill-opacity":.1})})},r.prototype.lowlight=function(){this.chordGroups.forEach(function(t){t.attr({"fill-opacity":.6})})},r.prototype.mouseclick=function(t,e){var i=this;this.chordGroups.forEach(function(o){var n=o.data("obj")[i.dimension.from],a=o.data("obj")[i.dimension.to];n==t&&a==e&&i.defaults.onClick&&i.defaults.onClick(o.data("clickVale"))})};var h=void 0;r.prototype.legendClick=function(t){var e=this;h!=t?(this.chordGroups.forEach(function(i){var o=i.data("obj")[e.dimension.from],n=i.data("obj")[e.dimension.to];o!==t&&n!==t?i.attr({"fill-opacity":.1}):i.attr({"fill-opacity":.6})}),h=t):(this.chordGroups.forEach(function(t){t.attr({"fill-opacity":.6})}),h=void 0)},r.prototype._layout=function(){this._setColor();var t=this.floatTag,i=this,s=null,r=0,h=o.clone(i.defaults.textStyle);h["font-size"]=h["font-size"]?parseInt(h["font-size"]):30,h["font-size"]=h["font-size"];var l=o.clone(i.defaults.graduationTextStyle);l["font-size"]=l["font-size"]?parseInt(l["font-size"]):20,l["font-size"]=l["font-size"];var u,d,c,f,m,p,g,v,y,x,w,b,k,S,C,M,D,T=this.xOffset,I=a.d3.layout.chord().padding(.05).sortSubgroups(a.d3.descending).matrix(i.matrix),z=I.groups(),O=a.d3.svg.arc().innerRadius(i.defaults.innerRadius).outerRadius(i.defaults.outerRadius).startAngle(function(t){return t.startAngle}).endAngle(function(t){return t.endAngle}),B=I.chords(),j=a.d3.svg.chord().radius(i.defaults.innerRadius);i.chordGroups=[],i.donutGroups=[],e(this.node).append(this.floatTag);var N,_,R,E,L,A,F,P,H,Y,G,V=function(){t&&t.show(this.data("obj"));var e=this.data("donutIndex");i.chordGroups.forEach(function(t){t.data("source")!==e&&t.data("target")!==e?t.attr({"fill-opacity":.1}):t.attr({"fill-opacity":.6})}),i.fire("hoverIn",i.groupNames[e])},W=function(){t&&t.hide();var e=this.data("donutIndex");i.chordGroups.forEach(function(t){t.data("source")!==e&&t.data("target")!==e&&t.attr({"fill-opacity":.6})}),i.fire("hoverOut",i.groupNames[e])},q=function(){t&&t.show(this.data("obj")),i.defaults.onMouseOver(this.data("obj")),i.chordGroups.forEach(function(t){t.attr("fill-opacity",.1)}),"Microsoft Internet Explorer"!==navigator.appName&&this.toFront(),this.attr("fill-opacity",.7),i.fire("hoverIn",i.groupNames[this.data("source")])},U=function(){i.defaults.onMouseOut(this.data("obj")),t&&t.hide(),i.chordGroups.forEach(function(t){t.attr("fill-opacity",.6)}),i.fire("hoverOut",i.groupNames[this.data("source")])};i.defaults.dataType&&i.defaults.dataType;for(N=0;N<=B.length-1;N++){f=j(B[N]);var X=i.info[B[N].source.index][B[N].target.index],K=i.info[B[N].target.index][B[N].source.index];(dt={})[i.dimension.from]=i.groupNames[B[N].source.index],dt[i.dimension.to]=i.groupNames[B[N].target.index],dt[i.dimension.from+"-"+i.dimension.value]=i.matrix[B[N].source.index][B[N].target.index],dt[i.dimension.to+"-"+i.dimension.value]=i.matrix[B[N].target.index][B[N].source.index],dt[i.dimension.from+"-"+i.dimension.info]=X,dt[i.dimension.to+"-"+i.dimension.info]=K,c=i.canvas.path().translate(T,i.defaults.height/2).attr({fill:i._getColor(dt,i.dimension.from),"fill-opacity":.6,stroke:"#d6d6d6","stroke-opacity":.1}).hover(q,U).data("source",B[N].source.index).data("target",B[N].target.index),a.setAnimation(this.defaults.animation,c,{path:f},300);for(var J=0,Z=0,Q=i.matrix[B[N].source.index].length;Z<Q;Z++)J=i.matrix[B[N].source.index][Z]+J;c.data("obj",dt);var $={};$[i.dimension.from]=i.groupNames[B[N].source.index],$[i.dimension.to]=i.groupNames[B[N].target.index],$[i.dimension.from+"-"+i.dimension.value]=B[N].source.value,$[i.dimension.to+"-"+i.dimension.value]=B[N].target.value,$[i.dimension.from+"-"+i.dimension.info]=X,$[i.dimension.to+"-"+i.dimension.info]=K,c.data("clickValue",$).click(function(){if(n.isMobile)return null;i.defaults.onClick&&i.defaults.onClick(this.data("clickValue"))}).mouseup(function(t){if(n.isMobile)return null;i.defaults.onMouseUp&&i.defaults.onMouseUp(t,this.data("clickValue"))}).touchstart(function(t){r=new Date,s&&clearTimeout(s);var e=this;q.call(e),s=setTimeout(function(){U.call(e),s&&clearTimeout(s)},3e3),i.defaults.onTouchStart(t,this.data("clickValue"))}).touchend(function(t){if(new Date-r<400)i.defaults.onClick&&i.defaults.onClick(t,this.data("clickValue"));else if(new Date-r>500)return}),i.chordGroups.push(c)}var tt=0;for(R=0;R<=z.length-1;R++)tt+=z[R].value;var et,it,ot,nt=function(t,e){t&&(t.attr(h),!h.color&&i.defaults.dataType&&2==i.defaults.dataType&&i.defaults.donutTextType&&1==i.defaults.donutTextType&&t.attr("fill",e))},at=0,st=a.tickRange(0,tt,20),rt=5,ht=1e3,lt=2;(void 0===this.defaults.showGraduation||this.defaults.showGraduation)&&(ht=i.defaults.graduation&&i.defaults.graduation.multiple?i.defaults.graduation.multiple:ht/1e3>=1?1e3:1,i.defaults.graduation&&i.defaults.graduation.unit?rt=i.defaults.graduation.unit:0==(rt=st[1]-st[0])&&(rt=1),rt/=ht);var ut=i.dimensionDomain[i.dimension.from];for(_=0;_<=z.length-1;_++){d=O(z[_]);var dt={},ct=ut.indexOf(i.groupNames[_])<ut.length/2?i.dimension.from:i.dimension.to;if(dt[ct]=i.groupNames[_],dt[ct+"-"+i.dimension.value]=Math.round(z[_].value),dt["百分比"]=(100*z[_].value/tt).toFixed(2),_,i.defaults.dataType&&2==i.defaults.dataType&&(180*z[_].startAngle/Math.PI>178?(1,_-at):at++),ot=i._getColor(dt,ct),(u=i.canvas.path(d).translate(T,i.defaults.height/2).data("donutIndex",_).attr({fill:ot,stroke:ot}).mouseover(V).mouseout(W).touchstart(function(t){if(r=new Date,n.isMobile){s&&clearTimeout(s);var e=this;V.call(e),s=setTimeout(function(){W.call(e),s&&clearTimeout(s)},3e3)}i.defaults.onTouchStart(t,this.data("clickValue"))}).touchend(function(t){if(new Date-r<400);else if(new Date-r>500)return})).data("obj",dt),i.donutGroups.push(u),it=i.groupNames[_].length,et=i.groupNames[_],0==i.defaults.textShowMode&&it>4&&(et=i.groupNames[_].substring(0,4)+".."),i.defaults.donutTextType&&1==i.defaults.donutTextType?180*(z[_].endAngle-z[_].startAngle)/Math.PI>3&&(E=(P=i.canvas.text()).attr("text",et),nt(P,ot),Y=H=180*z[_].startAngle/Math.PI+180*(z[_].endAngle-z[_].startAngle)/Math.PI/2-90,H+90>180&&(Y=H-180),A=(G=void 0===this.defaults.showGraduation||this.defaults.showGraduation?i.defaults.outerRadius+P.getBBox().width/2+17:i.defaults.outerRadius+P.getBBox().width/2+4)*Math.cos(H*Math.PI/180),F=G*Math.sin(H*Math.PI/180),L="T"+T+","+i.defaults.height/2+"R"+Y+"T"+A+","+F,E.transform(L).data("donutIndex",_)):(H=180*z[_].startAngle/Math.PI-83+90,Y=(180*z[_].startAngle/Math.PI-83)*Math.PI/180,A=((i.defaults.outerRadius-i.defaults.innerRadius)/2+i.defaults.innerRadius)*Math.cos(Y),F=((i.defaults.outerRadius-i.defaults.innerRadius)/2+i.defaults.innerRadius)*Math.sin(Y),L="T"+T+","+i.defaults.height/2+"R"+H+"T"+A+","+F,180*(z[_].endAngle-z[_].startAngle)/Math.PI>10&&(E=(P=i.canvas.text()).attr("text",et).transform(L),nt(P,ot))),void 0===this.defaults.showGraduation||this.defaults.showGraduation){if(0==z[_].value)continue;var ft;for(m=z[_].value/(ht*rt),this.defaults.showGraduationAmount&&1==this.defaults.showGraduationAmount&&(m=1,lt=1),p=180*(z[_].endAngle-z[_].startAngle)/Math.PI/m,ft=0;ft<=m;ft++)if(g=(v=180*z[_].startAngle/Math.PI-90+ft*p)*Math.PI/180,x=i.defaults.outerRadius*Math.cos(g),w=i.defaults.outerRadius*Math.sin(g),"T"+T+","+i.defaults.height/2+"T"+x+","+w,y="M"+(T+x)+","+(i.defaults.height/2+w)+"L"+(T+(i.defaults.outerRadius+6)*Math.cos(g))+","+(i.defaults.height/2+(i.defaults.outerRadius+6)*Math.sin(g)),i.canvas.path(y).attr({stroke:"#929292","stroke-width":"1px"}),ft%lt==0){if(1==lt&&0==ft)continue;b=v+90<180?"start":"end",k=v+90<180?null:"R180",M=(i.defaults.outerRadius+10)*Math.cos(g),D=(i.defaults.outerRadius+10)*Math.sin(g),C=i.defaults.graduation&&i.defaults.graduation.multiple?ft%2?"":Math.round(z[_].value/m*ft/ht):"original"==i.defaults.graduation.type?Math.round(z[_].value/m*ft):n.tickFormat(Math.round(z[_].value/m*ft)),S="T"+T+","+i.defaults.height/2+"R"+v+k+"T"+M+","+D,i.canvas.text(0,0,C).transform(S).attr(l).attr("text-anchor",b)}}}},r.prototype.mousedblclick=function(t,e,i){this.defaults.onDblClick&&this.defaults.onDblClick(t,e,i)},t.exports=r}(t)}).call(this,i(10)(t),i(18),i(16))},611:function(t,e,i){(function(t,e,o){
/*!***********************************************
Copyright (c) 2014, Neusoft Inc.
All rights reserved.
SaCa DataViz Version 2.0.0
************************************************/
!function(t){var n=i(531),a=i(561),s=i(563),r=i(566),h=n.extend(n.Chart,{initialize:function(t,e){this.type="CalendarChart",this.node=this.checkContainer(t),this.defaults.width=1300,this.defaults.height=770,this.defaults.startYear=1988,this.defaults.endYear=1989,this.defaults.legendStyle={fill:"black","font-size":"12px","text-anchor":"start"},this.defaults.yearStyle={fill:"black","font-size":"17px","text-anchor":"start"},this.defaults.labelStyle={fill:"black","font-size":"17px","text-anchor":"start"},this.defaults.isSorted=!1,this.defaults.showYearLabel=!0,this.defaults.showGroupLabel=!0,this.defaults.groupLabel=void 0,this.defaults.showStatistics=!0,this.defaults.rectColor=void 0,this.defaults.onSpecialColor=void 0,this.defaults.onClick=function(t){},this.setOptions(e),this.colorDict=[],this.colorToIndex=[],this.source,this.partNum=this.defaults.endYear-this.defaults.startYear+1,this.canvas,this.dimension={}}});h.prototype._getColor=function(t){var e=s.getThemeColor(this.owner.theme),i=t%(2*e.length),o=t%2;return e[i%2==0?i/2:(i-1)/2][o]},h.prototype._layout=function(){var t=this,i=this.defaults;if(!t.owner.legend||1!=t.owner.legend.showLegend&&void 0!=t.owner.legend.showLegend||(i.showLegend=!0),t.owner.legend&&t.owner.legend.data)if(i.rectColor=[],"custom"==t.owner.legend.colorMode&&t.owner.legend.legendColor)for(var r=0;r<t.owner.legend.legendColor.length;r++)i.rectColor.push({range:t.owner.legend.legendColor[r].name,color:t.owner.legend.legendColor[r].color});else for(r=0;r<t.owner.legend.data.length;r++)i.rectColor.push({range:t.owner.legend.data[r],color:void 0});var h=this.floatTag,l=i.startYear,u=i.endYear+1,d=10,c=!1;(i.showYearLabel||i.showGroupLabel)&&(c=!0);var f,m=this.source,p=e.keys(m),g=p.length*e.keys(m[p[0]]).length,v=.08*(x=i.width),y=x;for(c&&i.showLegend?f=.58*y:c&&!i.showLegend?f=.85*y:!c&&i.showLegend?(v=.04*y,f=.7*y):f=.9*y;(f/8+50)*g>i.height;){var x;v=.08*(x=.95*x),y=x,c&&i.showLegend?f=.58*y:c&&!i.showLegend?f=.85*y:!c&&i.showLegend?(v=.04*y,f=.7*y):f=.9*y}var w=[29,20,20,v],b=f/56,k=7*b+w[0]+w[2],S=e.clone(i.yearStyle);S["font-size"]=S["font-size"]?parseInt(S["font-size"]):20;var C=e.clone(i.labelStyle);C["font-size"]=C["font-size"]?parseInt(C["font-size"]):20;var M=e.clone(i.legendStyle);M["font-size"]=M["font-size"]?parseInt(M["font-size"]):12,1==i.adaption&&(S["font-size"]=parseInt(i.width/85)+"px",C["font-size"]=parseInt(i.width/85)+"px",M["font-size"]=parseInt(i.width/120)+"px");var D,T,I,z,O,B=a.d3.time.format("%w"),j=a.d3.time.format("%U"),N=a.d3.time.format("%Y-%m-%d"),_=t.colorD3,R=a.d3.range(l,u),E=(r=R.length,void 0),L=0,A=i.rectColor,F=function(r,l){D=a.d3.time.days(new Date(R[l],0,1),new Date(R[l]+1,0,1)),T=a.d3.time.months(new Date(R[l],0,1),new Date(R[l]+1,0,1));for(var u=e.values(m[r][T[l].getFullYear()]),c=[],p=0,g=u.length;p<g;p++)c.push(u[p][t.dimension.value]);var v=a.d3.values(m[r][R[l]]).length;for(p=0;p<v;p++){var y={};y[t.dimension.date]=N(D[p]),t.hasText?(y[t.dimension.value]=a.d3.values(m[r][T[l].getFullYear()])[p][t.dimension.value],y.text=a.d3.values(m[r][T[l].getFullYear()])[p].text,y[t.dimension.info]=a.d3.values(m[r][T[l].getFullYear()])[p][t.dimension.info]):(y[t.dimension.value]=a.d3.values(m[r][T[l].getFullYear()])[p][t.dimension.value],y[t.dimension.info]=a.d3.values(m[r][T[l].getFullYear()])[p][t.dimension.info]),i.groupLabel&&(y[t.dimension.group]=i.groupLabel[r]),I=j(D[p])*b,z=B(D[p])*b+d;var x=t.canvas.rect(I+w[3],z+L*k,b,b).data("temData",y).click(function(){if(n.isMobile)return null;i.onClick&&i.onClick(this.data("temData"))}).touchstart(function(){i.onClick&&i.onClick(this.data("temData"))}).mouseover(function(){this.attr("cursor","pointer"),h&&h.show(this.data("temData")),this.animate({"fill-opacity":1},150)}).mouseout(function(){h&&h.hide(),this.data("opacity")&&this.animate({"fill-opacity":this.data("opacity")},150)}),F=a.d3.values(m[r][T[l].getFullYear()])[p][t.dimension.value];!t.owner.legend&&i.onSpecialColor&&(E=s.getSpecialColor(i.onSpecialColor,y))?(t.colorDict[E]?t.colorDict[E]+=1:t.colorDict[E]=1,t.colorToIndex[E]=_(F)):A&&A[0].color?(E=q(F),t.colorDict[E]?t.colorDict[E]+=1:t.colorDict[E]=1,t.colorToIndex[E]=_(F)):(E=t._getColor(_(F)),t.colorDict[E]?t.colorDict[E]+=1:t.colorDict[E]=1,t.colorToIndex[E]=_(F)),n.svg?o(x.node).attr({stroke:"#000","stroke-opacity":".1",style:"fill:"+E}):x.attr({fill:E,stroke:"#000","stroke-opacity":"0.1"})}var P=(v/30).toFixed(0);for(p=0;p<P;p++)t.canvas.path(W(T[p])).attr("overflow","visible").transform("t"+w[3]+","+k*L);if(i.showYearLabel&&(text=t.canvas.text(.6*w[3],k*L+.2*k+d,R[l]).attr(S)),i.showGroupLabel&&O!=r){var H=void 0;H=i.groupLabel?i.groupLabel[r]:r,text=t.canvas.text(0,k*L+.2*k+d,H).attr(C)}if(O=r,i.showLegend){var Y=void 0,G=void 0,V=[],U=void 0;if(A&&A[0].color){var X=(k-w[0]-w[2])/6;for(p=0,g=A.length;p<g;p++){var K=A[p].color;0!=V.length&&V.length%6==0?(U=e.max(V)+5,G=t.canvas.rect(U,L*k+$%6*X+d,.02*f,.02*f)):G=t.canvas.rect(U||f+w[3]+parseInt(p/6)*f*.15,L*k+p%6*X+d,.02*f,.02*f),n.svg?o(G.node).attr({stroke:"#000","stroke-opacity":".1",style:"fill:"+A[p].color}):G.attr({fill:A[p].color,stroke:"#000","stroke-opacity":"0.1"});var J=G.getBBox();if(Y=t.canvas.text(J.x2+5,L*k+p%6*X+X/2+d,A[p].range[0]+"-"+A[p].range[1]).attr(M),i.showStatistics){J=Y.getBBox();var Z="NaN"==(t.colorDict[K]/v*100).toFixed(1)?0:(t.colorDict[K]/v*100).toFixed(1);Y=t.canvas.text(J.x2+5,L*k+p%6*X+X/2+d,(t.colorDict[K]||0)+Z!=0?" "+Z+"%":" 0%").attr(M)}}t.colorDict=[],t._clearRectColorCount()}else{var Q=_.quantiles(),$=0,tt=[];for(var p in t.colorDict)tt.push({colorText:p,value:t.colorDict[p]});tt=e.sortBy(tt,function(e){return t.colorToIndex[e.colorText]});for(p=0;p<tt.length;p++){X=(k-w[0]-w[2])/6;if(t.colorDict.hasOwnProperty(tt[p].colorText)){0!=V.length&&V.length%6==0?(U=e.max(V)+5,G=t.canvas.rect(U,L*k+$%6*X+d,.02*f,.02*f)):G=t.canvas.rect(U||f+w[3]+parseInt($/6)*f*.15,L*k+$%6*X+d,.02*f,.02*f),n.svg?o(G.node).attr({stroke:"#000","stroke-opacity":".1",style:"fill:"+tt[p].colorText}):G.attr({fill:tt[p].colorText,stroke:"#000","stroke-opacity":"0.1"});var et,it,ot=t.colorToIndex[tt[p].colorText];0==ot?(et=0,it=Q[0].toFixed(0)):ot==Q.length?(et=Q[ot-1].toFixed(0),it="无穷大"):(et=Q[ot-1].toFixed(0),it=Q[ot].toFixed(0));J=G.getBBox();Y=t.canvas.text(J.x2+5,L*k+$%6*X+X/2+d,et+"-"+it).attr(M),i.showStatistics&&(J=Y.getBBox(),Y=t.canvas.text(J.x2+5,L*k+$%6*X+X/2+d,t.colorDict[tt[p].colorText]+" ["+(t.colorDict[tt[p].colorText]/v*100).toFixed(1)+"%]").attr(M)),V.push(Y.getBBox().x2),$+=1}}t.colorDict=[]}}L++},P=0,H=i.isSorted?r-1:0,Y=r*p.length,G=p.shift();if(0==H)var V=setInterval(function(){P<Y?(H<r?(F(G,H),H++):(G=p.shift(),H=0,F(G,H++)),P++):clearInterval(V)},5);else V=setInterval(function(){P<Y?(H>=0?(F(G,H),H--):(G=p.shift(),F(G,H=r-1),H--),P++):clearInterval(V)},5);function W(t){var e=new Date(t.getFullYear(),t.getMonth()+1,0),i=+B(t),o=+j(t),n=+B(e),a=+j(e);return"M"+(o+1)*b+","+(i*b+d)+"H"+o*b+"V"+(7*b+d)+"H"+a*b+"V"+((n+1)*b+d)+"H"+(a+1)*b+"V"+(0+d)+"H"+(o+1)*b+"Z"}function q(t){for(var e=0,i=A.length;e<i;e++)if(A[e].range[0]<=t&&A[e].range[1]>=t)return A[e].count+=1,A[e].color}},h.prototype.render=function(){this._clearRectColorCount(),this._layout()},h.prototype.setSource=function(t){this.source=r.clone(t.source),this.dimensions=t.dimensions,this.dimensionType=t.dimensionType,this.dimensionDomain=t.dimensionDomain,this.dimension.date=t.dimensions[0],this.dimension.value=t.dimensions[1],this.dimension.group=t.dimensions[2],this.dimension.info=t.dimensions[3];var i=a.d3.scale.quantile();i.domain(this.dimensionDomain[this.dimension.value]).range(a.d3.range(9)),this.colorD3=i,this.hasText=e.has(this.source[0],"text");var o=void 0;-1!=this.source[0][this.dimension.date].indexOf("-")?o=a.d3.time.format("%Y-%m-%d"):-1!=this.source[0][this.dimension.date].indexOf("/")?o=a.d3.time.format("%Y/%m/%d"):alert("您数据中的日期格式不正确 eg:%Y-%m-%d 或者 %Y/%m/%d");var n=this;this.source=a.d3.nest().key(function(t){return t[n.dimension.group]}).key(function(t){return(t[n.dimension.date]=o.parse(t[n.dimension.date])).getFullYear()}).key(function(t){return t[n.dimension.date]}).rollup(function(t){var e={};e[n.dimension.value]=t[0][n.dimension.value],e.text=t[0].text,e[n.dimension.info]=t[0][n.dimension.info];var i={};return i[n.dimension.value]=t[0][n.dimension.value],i[n.dimension.info]=t[0][n.dimension.info],n.hasText?e:i}).map(this.source)},h.prototype._clearRectColorCount=function(){var t=this.defaults;if(t.rectColor)for(var e=t.rectColor.length,i=0;i<e;i++)t.rectColor[i].count=0},h.prototype.mousedblclick=function(t,e,i){this.defaults.onDblClick&&this.defaults.onDblClick(t,e,i)},t.exports=h}(t)}).call(this,i(10)(t),i(16),i(18))},612:function(t,e,i){(function(t){
/*!***********************************************
Copyright (c) 2014, Neusoft Inc.
All rights reserved.
SaCa DataViz Version 2.0.0
************************************************/
!function(t){var e=i(531),o=i(561),n=(i(563),i(579)),a=e.extend(e.Chart,{initialize:function(t,e){this.type="BulletChart",this.node=this.checkContainer(t),this.defaults.width=300,this.defaults.height=90,this.defaults.label="Title",this.defaults.labelStyle={fill:"#333","font-family":"Microsoft Yahei"},this.defaults.subLabel=" ",this.defaults.subLabelStyle={fill:"#333","font-family":"Microsoft Yahei"},this.defaults.ranges=void 0,this.defaults.horizonal=!0,this.defaults.axisType="linear",this.defaults.logBase=Math.E,this.defaults.tickDivide=5,this.defaults.margin=[20,20,20,60],this.defaults.centerBarRatio=.3,this.defaults.markerWidth=4,this.defaults.markerRatio=.7,this.defaults.labelRatio=.6,this.defaults.backgroundColor=["#666","#ddd"],this.defaults.measureColor=["steelblue","#B0C4DE"],this.defaults.markerColor="#000",this.defaults.animation=!0,this.defaults.onMouseOver=function(){},this.defaults.onMouseOut=function(){},this.setOptions(e),this._initEvent(),this.source,this.dimension={}}});a.prototype._initEvent=function(){var t=this,e=this.defaults;this.on("mouseover",function(){var i=arguments[0],o=arguments[1];(o=!(void 0!==o||!t.floatTag))&&t.floatTag.show(i),e.onMouseOver&&e.onMouseOver(arguments[0])}),this.on("mouseout",function(){t.floatTag&&t.floatTag.hide(),e.onMouseOut&&e.onMouseOut(arguments[0])})},a.prototype._layout=function(){var t,e,i=this.defaults,a=this.dimension;this.data={},this.data.marker=this.source[a.marker],this.data.measures=[];for(var s=0;s<a.measures.length;s++)this.data.measures[s]=this.source[a.measures[s]];1==i.horizonal?(e="bottom",t=[i.margin[3],i.width-i.margin[1]]):(e="left",t=[i.height-i.margin[2],i.margin[0]]),"linear"===i.axisType?this.scale=o.d3.scale.linear():"log"===i.axisType&&(this.scale=o.d3.scale.log()),this.data.min=i.ranges[0],this.data.max=i.ranges[i.ranges.length-1],this.scale.domain([this.data.min,this.data.max]).range(t),"linear"===i.axisType?this.axis=n().scale(this.scale).orient(e).ticks(i.tickDivide).domainAttr({stroke:"none"}):"log"===i.axisType&&(this.logScale=o.d3.scale.linear().domain([Math.log(this.data.min)/Math.log(i.logBase),Math.log(this.data.max)/Math.log(i.logBase)]).range(t),this.axis=n().orient(e).scale(this.logScale).ticks(i.tickDivide).tickFormat(function(t){return Math.round(Math.pow(i.logBase,t))}).domainAttr({stroke:"none"})),this.tarObj={},this.tarObj[this.dimension.marker]=this.data.marker;for(s=0;s<i.ranges.length;s++)this.tarObj["range"+s]=i.ranges[s];for(var r=0;r<this.data.measures.length;r++)this.tarObj[this.dimension.measures[r]]=this.data.measures[r]},a.prototype.paintHorizonal=function(){var t,e,i,n,a,s,r,h,l=this.defaults,u=this,d=this.canvas,c=this.data,f=l.margin,m=[],p=l.height-f[0]-f[2];for(this.axis(d).attr({transform:"t0,"+(l.height-f[2])}).attr({stroke:l.axisStroke}),t=l.ranges,h=f[3],i=0,n=t.length-1;i<n;i++)r=this.scale(t[i+1])-this.scale(t[i]),d.rect(h,f[0],r,p).attr({stroke:"none",fill:this.color(1===n?1:i/(n-1))}).data("i",i).mouseover(function(){u.fire("mouseover",u.tarObj)}).mouseout(function(){u.fire("mouseout")}),h+=r;if(m=c.measures,c.min>=0)for(m.sort(function(t,e){return o.d3.ascending(t,e)}),h=this.scale(c.min),i=0,n=m.length;i<n;i++)value=Math.max(c.min,Math.min(c.max,m[i])),r=this.scale(value)-h,a=d.rect(h,f[0]+p*(1-l.centerBarRatio)/2,0,p*l.centerBarRatio).attr({stroke:"none",fill:this.measureColor(1===n?1:i/(n-1))}).mouseover(function(){u.fire("mouseover",u.tarObj)}).mouseout(function(){u.fire("mouseout")}),o.setAnimation(this.defaults.animation,a,{width:r},300),h+=r;else if(c.max<=0)for(m.sort(function(t,e){return o.d3.descending(t,e)}),h=this.scale(c.max),i=0,n=m.length;i<n;i++)value=Math.min(c.max,Math.max(c.min,m[i])),r=h-this.scale(value),a=d.rect(h-r,f[0]+p*(1-l.centerBarRatio)/2,0,p*l.centerBarRatio).attr({stroke:"none",fill:this.measureColor(1===n?1:i/(n-1))}).mouseover(function(){u.fire("mouseover",u.tarObj)}).mouseout(function(){this.attr({stroke:"none"})}),o.setAnimation(this.defaults.animation,a,{width:r},300),h-=r;else{var g;for(m.sort(function(t,e){return o.d3.ascending(t,e)}),i=0,n=m.length;i<n;i++)value=Math.max(c.min,Math.min(c.max,m[i])),h=this.scale(0),value>=0?(r=this.scale(value)-h,g=h):g=h-(r=h-this.scale(value)),a=d.rect(g,f[0]+p*(1-l.centerBarRatio)/2,0,p*l.centerBarRatio).attr({stroke:"none",fill:this.measureColor(1===n?1:i/(n-1))}).mouseover(function(){u.fire("mouseover",u.tarObj)}).mouseout(function(){u.fire("mouseout")}),o.setAnimation(this.defaults.animation,a,{width:r},300),h+=r}e=c.marker,d.rect(this.scale(e)-l.markerWidth/2,f[0]+p*(1-l.markerRatio)/2,l.markerWidth,p*l.markerRatio).attr({stroke:"none",fill:l.markerColor}).mouseover(function(){u.fire("mouseover",u.tarObj)}).mouseout(function(){u.fire("mouseout")}),l.label&&(s=l.labelRatio,this.label=d.text(f[3]-5,f[0]+p/2,l.label).attr({"text-anchor":"end","font-weight":"bold","font-size":f[3]*s*.4}),this.label.attr(l.labelStyle)),l.subLabel&&(this.subLabel=d.text(f[3]-5,l.height-f[2],l.subLabel).attr({"text-anchor":"end","font-size":f[3]*s*.4}),this.subLabel.attr(l.subLabelStyle))},a.prototype.paintVertical=function(){var t,e,i,n,a,s,r,h,l=this.defaults,u=this,d=this.canvas,c=this.data,f=l.margin,m=[],p=l.width-f[1]-f[3];for(this.axis(d).attr({transform:"t"+f[3]+",0"}).attr({stroke:l.axisStroke}),t=l.ranges,h=l.height-f[2],i=0,n=t.length-1;i<n;i++)r=-this.scale(t[i+1])+this.scale(t[i]),d.rect(f[3],h-r,p,r).attr({stroke:"none",fill:this.color(1===n?1:i/(n-1))}).mouseover(function(){u.fire("mouseover",u.tarObj)}).mouseout(function(){u.fire("mouseout")}),h-=r;if(m=c.measures,c.min>=0)for(m.sort(function(t,e){return o.d3.ascending(t,e)}),h=this.scale(c.min),i=0,n=m.length;i<n;i++)value=Math.max(c.min,Math.min(c.max,m[i])),r=-this.scale(value)+h,a=d.rect(f[3]+p*(1-l.centerBarRatio)/2,h-r,p*l.centerBarRatio,0).attr({stroke:"none",fill:this.measureColor(1===n?1:i/(n-1))}).mouseover(function(){u.fire("mouseover",u.tarObj)}).mouseout(function(){u.fire("mouseout")}),o.setAnimation(this.defaults.animation,a,{height:r},200),h-=r;else if(c.max<=0)for(m.sort(function(t,e){return o.d3.descending(t,e)}),h=this.scale(c.max),i=0,n=m.length;i<n;i++)value=Math.min(c.max,Math.max(c.min,m[i])),r=this.scale(value)-h,a=d.rect(f[3]+p*(1-l.centerBarRatio)/2,h,p*l.centerBarRatio,0).attr({stroke:"none",fill:this.measureColor(1===n?1:i/(n-1))}).mouseover(function(){u.fire("mouseover",u.tarObj)}).mouseout(function(){u.fire("mouseout")}),o.setAnimation(this.defaults.animation,a,{height:r},300),h+=r;else{m.sort(function(t,e){return o.d3.ascending(t,e)}),h=this.scale(0);var g=0;for(i=0,n=m.length;i<n;i++)value=Math.max(c.min,Math.min(c.max,m[i])),value>=0?g=h-(r=-this.scale(value)+h):(r=this.scale(value)-h,g=h),a=d.rect(f[3]+p*(1-l.centerBarRatio)/2,g,p*l.centerBarRatio,0).attr({stroke:"none",fill:this.measureColor(1===n?1:i/(n-1))}).mouseover(function(){u.fire("mouseover",u.tarObj)}).mouseout(function(){u.fire("mouseout")}),o.setAnimation(this.defaults.animation,a,{height:r},300)}if(e=c.marker,d.rect(f[3]+p*(1-l.markerRatio)/2,this.scale(e)-l.markerWidth/2,p*l.markerRatio,l.markerWidth).attr({stroke:"none",fill:l.markerColor}).mouseover(function(){u.fire("mouseover",u.tarObj)}).mouseout(function(){u.fire("mouseout")}),s=l.subLabel?l.labelRatio:1,l.label){var v=.9*f[0];this.label=d.text((l.width+f[3]-f[1])/2,v*s/2,l.label).attr({"text-anchor":"middle","font-weight":"bold","font-size":v*s*.6})}l.subLabel&&(this.subtitle=d.text((l.width+f[3]-f[1])/2,f[0]*(1-(1-s)/2),l.subLabel).attr({"text-anchor":"middle","font-size":f[0]*(1-s)*.6}))},a.prototype.generatePaths=function(){var t=this.defaults;t.backgroundColor&&(this.color=o.d3.interpolateRgb.apply(null,[t.backgroundColor[0],t.backgroundColor[1]])),t.measureColor&&(this.measureColor=o.d3.interpolateRgb.apply(null,[t.measureColor[0],t.measureColor[1]])),1==t.horizonal?this.paintHorizonal():this.paintVertical()},a.prototype._changePercent=function(t,e,i,o){o||((o={}).top=0,o.right=1,o.bottom=2,o.left=3);for(var n=0;n<t.length;n++)if(isNaN(t[n])){var a=t[n].length;if("%"==t[n].substring(a-1,a)&&!isNaN(t[n].substring(0,a-1))){var s=Number(t[n].substring(0,a-1));for(var r in o)if(o[r]==n){if("top"==r||"bottom"==r){t[n]=s/100*i;break}t[n]=s/100*e;break}}}return t},a.prototype.render=function(){this._changePercent(this.defaults.margin,this.defaults.width,this.defaults.height),this._layout(),this.generatePaths(),this._layout()},a.prototype.setSource=function(t){this.dimensions=t.dimensions,this.dimension.marker=t.dimensions[0],this.dimension.measures=[];for(var e=0;e<t.dimensions.length-1;e++)this.dimension.measures[e]=t.dimensions[e+1];this.source=t.source[0]},t.exports=a}(t)}).call(this,i(10)(t))},613:function(t,e,i){var o={"./bullet.js":612,"./calendar.js":611,"./chart.js":597,"./chord.js":610,"./dot.js":609,"./doubleline.js":608,"./hotmap.js":607,"./pinterest.js":606,"./rose.js":605,"./stream.js":604,"./sunburst.js":595,"./tagcloud.js":599,"./tree.js":598};function n(t){var e=a(t);return i(e)}function a(t){var e=o[t];if(!(e+1)){var i=new Error("Cannot find module '"+t+"'");throw i.code="MODULE_NOT_FOUND",i}return e}n.keys=function(){return Object.keys(o)},n.resolve=a,t.exports=n,n.id=613}}]);